
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Mutual-information at the contact level &#8212; frites 0.4.0 documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/blank.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/frites_style.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Trial-resampling: correcting for unbalanced designs" href="../estimators/plot_est_resample.html" />
    <link rel="prev" title="Compute a conjunction analysis on mutual-information" href="plot_mi_conjunction.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
<head>
<style>
@import url('https://fonts.googleapis.com/css2?family=Maven+Pro&family=Roboto+Mono:wght@332&display=swap');
</style>
</head>

    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/frites_top.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../overview/index.html">
  Overview
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../install.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../api/index.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../index.html">
  Examples
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/brainets/frites" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/kNearNeighbors" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/plot_dfc_estimator.html">
   Estimate the Dynamic Functional Connectivity
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/plot_stim_spec_network.html">
   Statistical analysis of a stimulus-specific network
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../dataset/plot_dataset_mne.html">
   Define an electrophysiological dataset using MNE-Python structures
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../dataset/plot_dataset_ephy.html">
   Build an electrophysiological dataset
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../dataset/plot_dataset_xarray.html">
   Define an electrophysiological dataset using Xarray
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_wf_mi_ccd.html">
   MI between two continuous variables conditioned by a discret one
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_wf_mi_cd.html">
   MI between a continuous and a discret variables
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_mi_time_frequency.html">
   Compute MI across time and frequencies
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_wf_mi_cc.html">
   MI between two continuous variables
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_wf_mi_combine.html">
   Investigate relation of order
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_mi_conjunction.html">
   Compute a conjunction analysis on mutual-information
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Mutual-information at the contact level
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../estimators/plot_est_resample.html">
   Trial-resampling: correcting for unbalanced designs
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../estimators/plot_est_custom.html">
   Defining a custom estimator
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../estimators/plot_est_comparison.html">
   Estimator comparison
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../conn/plot_dfc.html">
   Estimate dynamic functional connectivity
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../conn/plot_conn.html">
   Estimate comodulations between brain areas
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../conn/plot_ccf.html">
   Lag estimation between delayed times-series using the cross-correlation
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../conn/plot_covgc.html">
   Estimate the covariance-based Granger Causality
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../armodel/plot_ar_pairwise.html">
   AR : pairwise illustration
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../armodel/plot_ar_instantaneous.html">
   AR : simulate common driving input
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../armodel/plot_ar_condcovgc.html">
   AR : conditional covariance based Granger Causality
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../utils/plot_time_windows.html">
   Define temporal windows
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../statistics/plot_wf_mi_stats_compare_rfx.html">
   Compare between-subjects statistics when computing mutual information
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../statistics/plot_wf_mi_stats_compare_ffx.html">
   Compare within-subjects statistics when computing mutual information
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../simulations/plot_generate_random_data.html">
   Generate random electrophysiological data
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../xarray/plot_xr_export.html">
   Xarray : Saving the results
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../xarray/plot_xr_quick_tour.html">
   Xarray : Quick tour
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#i-continuous-continuous-case">
   I(Continuous; Continuous) case
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#i-continuous-discret-case">
   I(Continuous; Discret) case
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#i-continuous-continuous-discret-case">
   I(Continuous ; Continuous | Discret) case
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#xarray-definition-with-multi-indexing">
   Xarray definition with multi-indexing
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-mi-plot-wf-mi-contact-level-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="mutual-information-at-the-contact-level">
<span id="sphx-glr-auto-examples-mi-plot-wf-mi-contact-level-py"></span><h1>Mutual-information at the contact level<a class="headerlink" href="#mutual-information-at-the-contact-level" title="Permalink to this headline">¶</a></h1>
<p>This example illustrates how to compute the mutual information inside each
brain region and also by taking into consideration the information at a lower
anatomical level (e.g sEEG contact, MEG sensor etc.).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="kn">from</span> <span class="nn">frites.dataset</span> <span class="kn">import</span> <a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class"><span class="n">DatasetEphy</span></a>
<span class="kn">from</span> <span class="nn">frites.workflow</span> <span class="kn">import</span> <a href="../../api/generated/frites.workflow.WfMi.html#frites.workflow.WfMi" title="frites.workflow.WfMi" class="sphx-glr-backref-module-frites-workflow sphx-glr-backref-type-py-class"><span class="n">WfMi</span></a>
<span class="kn">from</span> <span class="nn">frites.core</span> <span class="kn">import</span> <span class="n">mi_nd_gg</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<section id="i-continuous-continuous-case">
<h2>I(Continuous; Continuous) case<a class="headerlink" href="#i-continuous-continuous-case" title="Permalink to this headline">¶</a></h2>
<p>Let’s start by simulating by using random data in combination with normal
distributions. To explain why it could be interesting to consider the
information at the single contact level, we generate the data coming from one
single brain region (‘roi_0’) but with two contacts inside (‘c1’, ‘c2’).
For the first the contact, the brain data are going to be positively
correlated with the normal distribution while the second contact is going to
have negative correlations. If you concatenate the data of the two contacts,
the mix of positive and negative correlations break the monotonic
assumption of the GCMI. In that case, it’s better to compute the MI per
contact</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n_suj</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n_trials</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">n_times</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">half</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_trials</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_times</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">roi</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">suj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_suj</span><span class="p">):</span>
    <span class="c1"># initialize subject&#39;s data with random noise</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_times</span><span class="p">)</span>
    <span class="c1"># normal continuous regressor</span>
    <span class="n">_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,))</span>

    <span class="c1"># first contact has positive correlations</span>
    <span class="n">_x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># second contact has negative correlations</span>
    <span class="n">_x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">-=</span> <span class="n">_y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_x</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_y</span><span class="p">]</span>
    <span class="n">roi</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;roi_0&#39;</span><span class="p">,</span> <span class="s1">&#39;roi_0&#39;</span><span class="p">])]</span>

<span class="c1"># now, compute the mi with default parameters</span>
<a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ds</span></a> <span class="o">=</span> <a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class"><span class="n">DatasetEphy</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="n">roi</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> <span class="n">agg_ch</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mi</span> <span class="o">=</span> <a href="../../api/generated/frites.workflow.WfMi.html#frites.workflow.WfMi" title="frites.workflow.WfMi" class="sphx-glr-backref-module-frites-workflow sphx-glr-backref-type-py-class"><span class="n">WfMi</span></a><span class="p">(</span><span class="n">mi_type</span><span class="o">=</span><span class="s1">&#39;cc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ds</span></a><span class="p">,</span> <span class="n">mcp</span><span class="o">=</span><span class="s1">&#39;noperm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># compute the mi at the contact level</span>
<a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ds</span></a> <span class="o">=</span> <a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class"><span class="n">DatasetEphy</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="n">roi</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> <span class="n">agg_ch</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">mi_c</span> <span class="o">=</span> <a href="../../api/generated/frites.workflow.WfMi.html#frites.workflow.WfMi" title="frites.workflow.WfMi" class="sphx-glr-backref-module-frites-workflow sphx-glr-backref-type-py-class"><span class="n">WfMi</span></a><span class="p">(</span><span class="n">mi_type</span><span class="o">=</span><span class="s1">&#39;ccd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ds</span></a><span class="p">,</span> <span class="n">mcp</span><span class="o">=</span><span class="s1">&#39;noperm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># plot the comparison</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MI across contacts&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">mi_c</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MI at the contact level&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;I(C; C)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_wf_mi_contact_level_001.png" srcset="../../_images/sphx_glr_plot_wf_mi_contact_level_001.png" alt="I(C; C)" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  0%|          | Estimating MI : 0/1 [00:00&lt;?,       ?it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   40.81it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   40.11it/s]

  0%|          | Estimating MI : 0/1 [00:00&lt;?,       ?it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   49.67it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   49.01it/s]
</pre></div>
</div>
</section>
<section id="i-continuous-discret-case">
<h2>I(Continuous; Discret) case<a class="headerlink" href="#i-continuous-discret-case" title="Permalink to this headline">¶</a></h2>
<p>Same example as above except that this time the MI is compute between the
data and a discret variable</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">roi</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">suj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_suj</span><span class="p">):</span>
    <span class="c1"># initialize subject&#39;s data with random noise</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_times</span><span class="p">)</span>
    <span class="c1"># define a positive and negative offsets of 1</span>
    <span class="n">_y_pos</span><span class="p">,</span> <span class="n">_y_neg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">half</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mf">1.</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">half</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="mf">1.</span><span class="p">)</span>

    <span class="c1"># first contact / first half trials : positive offset</span>
    <span class="n">_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">half</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y_pos</span>
    <span class="c1"># first contact / second half trials : negative offset</span>
    <span class="n">_x</span><span class="p">[</span><span class="n">half</span><span class="p">::,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y_neg</span>
    <span class="c1"># second contact / first half trials : negative offset</span>
    <span class="n">_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">half</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y_neg</span>
    <span class="c1"># second contact / second half trials : positive offset</span>
    <span class="n">_x</span><span class="p">[</span><span class="n">half</span><span class="p">::,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y_pos</span>

    <span class="n">x</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_x</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">half</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">half</span><span class="p">)]</span>
    <span class="n">roi</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;roi_0&#39;</span><span class="p">,</span> <span class="s1">&#39;roi_0&#39;</span><span class="p">])]</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_times</span><span class="p">)</span>

<span class="c1"># now, compute the mi with default parameters</span>
<a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ds</span></a> <span class="o">=</span> <a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class"><span class="n">DatasetEphy</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="n">roi</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">)</span>
<span class="n">mi</span> <span class="o">=</span> <a href="../../api/generated/frites.workflow.WfMi.html#frites.workflow.WfMi" title="frites.workflow.WfMi" class="sphx-glr-backref-module-frites-workflow sphx-glr-backref-type-py-class"><span class="n">WfMi</span></a><span class="p">(</span><span class="n">mi_type</span><span class="o">=</span><span class="s1">&#39;cd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ds</span></a><span class="p">,</span> <span class="n">mcp</span><span class="o">=</span><span class="s1">&#39;noperm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># compute the mi at the contact level</span>
<a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ds</span></a> <span class="o">=</span> <a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class"><span class="n">DatasetEphy</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="n">roi</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> <span class="n">agg_ch</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">mi_c</span> <span class="o">=</span> <a href="../../api/generated/frites.workflow.WfMi.html#frites.workflow.WfMi" title="frites.workflow.WfMi" class="sphx-glr-backref-module-frites-workflow sphx-glr-backref-type-py-class"><span class="n">WfMi</span></a><span class="p">(</span><span class="n">mi_type</span><span class="o">=</span><span class="s1">&#39;cd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ds</span></a><span class="p">,</span> <span class="n">mcp</span><span class="o">=</span><span class="s1">&#39;noperm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># plot the comparison</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MI across contacts&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">mi_c</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MI at the contact level&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;I(C; D)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_wf_mi_contact_level_002.png" srcset="../../_images/sphx_glr_plot_wf_mi_contact_level_002.png" alt="I(C; D)" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  0%|          | Estimating MI : 0/1 [00:00&lt;?,       ?it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   42.88it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   42.11it/s]

  0%|          | Estimating MI : 0/1 [00:00&lt;?,       ?it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   52.68it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   51.87it/s]
</pre></div>
</div>
</section>
<section id="i-continuous-continuous-discret-case">
<h2>I(Continuous ; Continuous | Discret) case<a class="headerlink" href="#i-continuous-continuous-discret-case" title="Permalink to this headline">¶</a></h2>
<p>Same example as above except that this time the MI is compute between the
data and a discret variable</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">roi</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">suj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_suj</span><span class="p">):</span>
    <span class="c1"># initialize subject&#39;s data with random noise</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_times</span><span class="p">)</span>
    <span class="c1"># define a positive and negative correlations</span>
    <span class="n">_y_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">half</span><span class="p">))</span>
    <span class="n">_y_neg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">half</span><span class="p">))</span>
    <span class="n">_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">_y_pos</span><span class="p">,</span> <span class="n">_y_neg</span><span class="p">]</span>
    <span class="n">_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">half</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">half</span><span class="p">)</span>

    <span class="c1"># first contact / first half trials : positive offset</span>
    <span class="n">_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">half</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y_pos</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># first contact / second half trials : negative offset</span>
    <span class="n">_x</span><span class="p">[</span><span class="n">half</span><span class="p">::,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y_neg</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># second contact / first half trials : negative offset</span>
    <span class="n">_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">half</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y_neg</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># second contact / second half trials : positive offset</span>
    <span class="n">_x</span><span class="p">[</span><span class="n">half</span><span class="p">::,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y_pos</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_x</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_y</span><span class="p">]</span>
    <span class="n">z</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_z</span><span class="p">]</span>
    <span class="n">roi</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;roi_0&#39;</span><span class="p">,</span> <span class="s1">&#39;roi_0&#39;</span><span class="p">])]</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_times</span><span class="p">)</span>

<span class="c1"># now, compute the mi with default parameters</span>
<a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ds</span></a> <span class="o">=</span> <a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class"><span class="n">DatasetEphy</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="n">roi</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">)</span>
<span class="n">mi</span> <span class="o">=</span> <a href="../../api/generated/frites.workflow.WfMi.html#frites.workflow.WfMi" title="frites.workflow.WfMi" class="sphx-glr-backref-module-frites-workflow sphx-glr-backref-type-py-class"><span class="n">WfMi</span></a><span class="p">(</span><span class="n">mi_type</span><span class="o">=</span><span class="s1">&#39;ccd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ds</span></a><span class="p">,</span> <span class="n">mcp</span><span class="o">=</span><span class="s1">&#39;noperm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># compute the mi at the contact level</span>
<a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ds</span></a> <span class="o">=</span> <a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class"><span class="n">DatasetEphy</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="n">roi</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> <span class="n">agg_ch</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">mi_c</span> <span class="o">=</span> <a href="../../api/generated/frites.workflow.WfMi.html#frites.workflow.WfMi" title="frites.workflow.WfMi" class="sphx-glr-backref-module-frites-workflow sphx-glr-backref-type-py-class"><span class="n">WfMi</span></a><span class="p">(</span><span class="n">mi_type</span><span class="o">=</span><span class="s1">&#39;ccd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ds</span></a><span class="p">,</span> <span class="n">mcp</span><span class="o">=</span><span class="s1">&#39;noperm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># plot the comparison</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MI across contacts&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">mi_c</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MI at the contact level&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;I(C; C | D)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_wf_mi_contact_level_003.png" srcset="../../_images/sphx_glr_plot_wf_mi_contact_level_003.png" alt="I(C; C | D)" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  0%|          | Estimating MI : 0/1 [00:00&lt;?,       ?it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   38.60it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   37.93it/s]

  0%|          | Estimating MI : 0/1 [00:00&lt;?,       ?it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   46.43it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   45.66it/s]
</pre></div>
</div>
</section>
<section id="xarray-definition-with-multi-indexing">
<h2>Xarray definition with multi-indexing<a class="headerlink" href="#xarray-definition-with-multi-indexing" title="Permalink to this headline">¶</a></h2>
<p>Finally, we show below how to use Xarray in combination with pandas
multi-index to define an electrophysiological dataset</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">suj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_suj</span><span class="p">):</span>
    <span class="c1"># initialize subject&#39;s data with random noise</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_times</span><span class="p">)</span>
    <span class="c1"># normal continuous regressor</span>
    <span class="n">_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,))</span>

    <span class="c1"># first contact has positive correlations</span>
    <span class="n">_x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># second contact has negative correlations</span>
    <span class="n">_x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">-=</span> <span class="n">_y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># roi and contacts definitions</span>
    <span class="n">_roi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;roi_0&#39;</span><span class="p">,</span> <span class="s1">&#39;roi_0&#39;</span><span class="p">])</span>
    <span class="n">_contacts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;c1&#39;</span><span class="p">,</span> <span class="s1">&#39;c2&#39;</span><span class="p">])</span>

    <span class="c1"># multi-index definition</span>
    <span class="n">midx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span><span class="n">_roi</span><span class="p">,</span> <span class="n">_contacts</span><span class="p">],</span>
                                     <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;parcel&#39;</span><span class="p">,</span> <span class="s1">&#39;contacts&#39;</span><span class="p">))</span>
    <span class="c1"># xarray definition</span>
    <span class="n">_x_xr</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;trials&#39;</span><span class="p">,</span> <span class="s1">&#39;space&#39;</span><span class="p">,</span> <span class="s1">&#39;times&#39;</span><span class="p">),</span>
                         <span class="n">coords</span><span class="o">=</span><span class="p">(</span><span class="n">_y</span><span class="p">,</span> <span class="n">midx</span><span class="p">,</span> <span class="n">times</span><span class="p">))</span>

    <span class="n">x</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_x_xr</span><span class="p">]</span>

<span class="c1"># finally, define the electrophysiological dataset and specify the dimension</span>
<span class="c1"># names to use</span>
<a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ds_xr</span></a> <span class="o">=</span> <a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class"><span class="n">DatasetEphy</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;trials&#39;</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="s1">&#39;parcel&#39;</span><span class="p">,</span> <span class="n">agg_ch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="s1">&#39;times&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ds_xr</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;xarray.DataArray &#39;subject_0&#39; (trials: 20, roi: 2, times: 100)&gt;
array([[[0.04608988, 0.25187885, 0.8936789 , ..., 0.48303874,
         0.7120282 , 0.79089873],
        [0.46176804, 0.47764443, 0.94512574, ..., 0.80025414,
         0.09014837, 0.05485578]],

       [[0.38087306, 0.1069971 , 0.53584365, ..., 0.61624591,
         0.14365582, 0.52714389],
        [0.72482002, 0.28171669, 0.42760885, ..., 0.58501399,
         0.12640082, 0.38343104]],

       [[0.45367127, 0.36227826, 0.53295643, ..., 0.15492837,
         0.18324772, 0.45941863],
        [0.77405482, 0.14281299, 0.28495053, ..., 0.35431493,
         0.71435022, 0.51970891]],

       ...,

       [[0.46871119, 0.54233485, 0.94007768, ..., 0.25342761,
         0.87339175, 0.65501448],
        [0.10979493, 0.42690881, 0.94413044, ..., 0.5860685 ,
         0.01552855, 0.02975621]],

       [[0.7726105 , 0.362614  , 0.94003118, ..., 0.89229301,
         0.77831937, 0.50464711],
        [0.70852249, 0.49352853, 0.61755073, ..., 0.68952305,
         0.20884602, 0.33269399]],

       [[0.14346912, 0.32541363, 0.2178995 , ..., 0.1731115 ,
         0.27726039, 0.65926042],
        [0.34086676, 0.07158322, 0.80062377, ..., 0.81184183,
         0.60395198, 0.06233412]]])
Coordinates:
  * trials   (trials) int64 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19
    y        (trials) float64 0.5707 -1.283 0.4294 ... -1.162 1.281 0.9606
  * roi      (roi) object &#39;roi_0&#39; &#39;roi_0&#39;
    agg_ch   (roi) int64 0 1
  * times    (times) int64 0 1 2 3 4 5 6 7 8 9 ... 90 91 92 93 94 95 96 97 98 99
    subject  (trials) int64 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
Attributes:
    __version__:   0.4.0
    modality:      electrophysiology
    dtype:         SubjectEphy
    y_dtype:       float
    z_dtype:       none
    mi_type:       cc
    mi_repr:       I(x; y (continuous))
    sfreq:         1.0
    agg_ch:        1
    multivariate:  0
&lt;xarray.DataArray &#39;subject_1&#39; (trials: 20, roi: 2, times: 100)&gt;
array([[[9.19466316e-01, 8.21236794e-01, 6.70058541e-01, ...,
         3.52211824e-01, 6.96441458e-01, 3.86844041e-01],
        [5.36376936e-01, 9.51176372e-01, 7.60618103e-01, ...,
         3.71208235e-01, 1.05570924e-01, 1.53340955e-01]],

       [[8.29216346e-01, 1.01345880e-01, 2.28852007e-02, ...,
         9.62681755e-02, 8.14109284e-01, 4.31654670e-01],
        [6.19026687e-01, 9.67607882e-01, 2.77077140e-01, ...,
         4.56829272e-01, 6.42263176e-01, 4.69528763e-01]],

       [[2.69785675e-01, 6.82829256e-01, 5.31722627e-01, ...,
         7.04391326e-01, 1.01376098e-01, 5.31955236e-01],
        [4.98312374e-01, 9.18412026e-01, 9.03028894e-01, ...,
         5.28302779e-01, 8.58719012e-02, 9.97191452e-01]],

       ...,

       [[2.44212124e-01, 1.94921999e-01, 9.36379084e-01, ...,
         1.90318451e-01, 3.21849061e-01, 1.91878868e-01],
        [3.84710709e-01, 9.90222054e-01, 7.04799892e-01, ...,
         1.40051880e-04, 7.22737495e-01, 8.17000650e-01]],

       [[6.28246660e-01, 1.45467362e-01, 2.33884830e-01, ...,
         2.31776800e-01, 9.35225243e-01, 4.77064449e-01],
        [6.78557060e-01, 9.04930262e-01, 8.89970036e-01, ...,
         6.80134486e-01, 4.41983189e-01, 1.65876993e-01]],

       [[3.16622299e-02, 2.32988977e-01, 1.26102759e-02, ...,
         1.07618230e-01, 8.66270978e-01, 5.17890639e-01],
        [2.10949442e-02, 5.12575238e-01, 8.05830570e-01, ...,
         8.83697495e-01, 9.67984104e-01, 1.40748582e-01]]])
Coordinates:
  * trials   (trials) int64 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19
    y        (trials) float64 0.15 0.6595 -0.7507 ... -0.8166 1.046 0.6222
  * roi      (roi) object &#39;roi_0&#39; &#39;roi_0&#39;
    agg_ch   (roi) int64 2 3
  * times    (times) int64 0 1 2 3 4 5 6 7 8 9 ... 90 91 92 93 94 95 96 97 98 99
    subject  (trials) int64 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
Attributes:
    __version__:   0.4.0
    modality:      electrophysiology
    dtype:         SubjectEphy
    y_dtype:       float
    z_dtype:       none
    mi_type:       cc
    mi_repr:       I(x; y (continuous))
    sfreq:         1.0
    agg_ch:        1
    multivariate:  0
&lt;xarray.DataArray &#39;subject_2&#39; (trials: 20, roi: 2, times: 100)&gt;
array([[[0.84858565, 0.85467303, 0.39102823, ..., 0.94994458,
         0.74050804, 0.53011584],
        [0.86823597, 0.16110701, 0.83469725, ..., 0.02595844,
         0.84985668, 0.62091708]],

       [[0.21507821, 0.30332323, 0.03791868, ..., 0.5169094 ,
         0.29311825, 0.1182778 ],
        [0.36352503, 0.51144101, 0.91714537, ..., 0.19894653,
         0.12989538, 0.6733914 ]],

       [[0.68320104, 0.66988669, 0.73517916, ..., 0.1742991 ,
         0.47452324, 0.35117635],
        [0.06803223, 0.05061179, 0.31825044, ..., 0.14319077,
         0.11457355, 0.22801003]],

       ...,

       [[0.9234038 , 0.84787553, 0.54949403, ..., 0.34694349,
         0.23850229, 0.90141045],
        [0.85689755, 0.58634898, 0.47348363, ..., 0.11916068,
         0.20430184, 0.94104859]],

       [[0.24889365, 0.65346191, 0.9723311 , ..., 0.70532726,
         0.64135543, 0.17380804],
        [0.0030579 , 0.33352381, 0.57252568, ..., 0.93987605,
         0.5877531 , 0.05234958]],

       [[0.06938666, 0.10881912, 0.25568863, ..., 0.43730851,
         0.13823433, 0.15324658],
        [0.13131932, 0.69157669, 0.72327741, ..., 0.52639735,
         0.10726363, 0.46465001]]])
Coordinates:
  * trials   (trials) int64 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19
    y        (trials) float64 0.1852 0.2634 -0.5581 ... 0.4496 -0.5455 0.8571
  * roi      (roi) object &#39;roi_0&#39; &#39;roi_0&#39;
    agg_ch   (roi) int64 4 5
  * times    (times) int64 0 1 2 3 4 5 6 7 8 9 ... 90 91 92 93 94 95 96 97 98 99
    subject  (trials) int64 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
Attributes:
    __version__:   0.4.0
    modality:      electrophysiology
    dtype:         SubjectEphy
    y_dtype:       float
    z_dtype:       none
    mi_type:       cc
    mi_repr:       I(x; y (continuous))
    sfreq:         1.0
    agg_ch:        1
    multivariate:  0
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  1.662 seconds)</p>
<p><strong>Estimated memory usage:</strong>  8 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-mi-plot-wf-mi-contact-level-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/23497494d94c2d1ff4ef55c6e8ee1397/plot_wf_mi_contact_level.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_wf_mi_contact_level.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/66081c9fb93014c1bdfccab1eccfba52/plot_wf_mi_contact_level.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_wf_mi_contact_level.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="plot_mi_conjunction.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Compute a conjunction analysis on mutual-information</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../estimators/plot_est_resample.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Trial-resampling: correcting for unbalanced designs</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

    <hr>
    <footer>
        <div class="container">
            <img src="../../_static/baniere.png" alt="Ban" height="80">
        </div>
        <br>
        <!-- <br> -->
        <p>&copy; Copyright Last updated on 2021-11-09.</p>
    </footer>

  </body>
</html>