<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Mutual-information at the contact level &#8212; frites 0.3.9 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/frites_style.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Estimate dynamic functional connectivity" href="../conn/plot_dfc.html" />
    <link rel="prev" title="Compute a conjunction analysis on mutual-information" href="plot_mi_conjunction.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>
<head>
<style>
@import url('https://fonts.googleapis.com/css2?family=Maven+Pro&family=Roboto+Mono:wght@332&display=swap');
</style>
</head>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/frites_128x128.png"></span>
          frites</a>
        <span class="navbar-text navbar-version pull-left"><b>0.3.9</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../overview.html">Overview</a></li>
                <li><a href="../../install.html">Install</a></li>
                <li><a href="../../community.html">Community</a></li>
                <li><a href="../../api.html">API</a></li>
                <li><a href="../index.html">Examples</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../overview.html#goals-of-frites">1. Goals of Frites</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../overview.html#task-related-and-feature-specificity">1.1 Task-related and feature-specificity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview.html#it-framework-to-extract-task-related-cognitive-brain-networks">1.2 IT framework to extract task-related cognitive brain networks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../overview.html#methods">2. Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../overview.html#data-analysis-within-the-information-theoretical-framework">2.1 Data analysis within the information theoretical framework</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../overview.html#gaussian-copula-mutual-information">2.1.1 Gaussian Copula Mutual Information</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../overview.html#the-different-types-of-mutual-informations">2.1.2 The different types of mutual informations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../overview.html#equivalence-with-other-statistical-measures">2.1.3 Equivalence with other statistical measures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../overview.html#references">2.1.4 References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../overview.html#statistical-analyses">2.2 Statistical analyses</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../overview.html#subject-and-group-level-statistical-inferences">2.2.1 Subject and group-level statistical inferences</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../overview.html#correction-for-multiple-comparisons">2.2.2 Correction for multiple comparisons</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../overview.html#id6">2.2.3 References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../overview.html#what-you-need-to-know-to-start-analyzing-your-data-with-frites">3. What you need to know to start analyzing your data with Frites</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../overview.html#package-organization">3.1 Package organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview.html#main-frites-workflows">3.2 Main Fritesâ€™ workflows</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../overview.html#deep-integration-with-xarray">3.3 Deep integration with Xarray</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../install.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install.html#installation-from-pip">Installation from pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install.html#installation-from-github">Installation from Github</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install.html#developer-installation">Developer installation</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#tutorials">Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/plot_dfc_estimator.html">Estimate the Dynamic Functional Connectivity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/plot_dfc_estimator.html#data-simulation">Data simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/plot_dfc_estimator.html#computes-the-dfc-in-a-single-temporal-window">Computes the DFC in a single temporal window</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/plot_dfc_estimator.html#computes-the-dfc-on-sliding-windows">Computes the DFC on sliding windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/plot_dfc_estimator.html#comparison-of-several-estimators">Comparison of several estimators</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/plot_stim_spec_network.html">Statistical analysis of a stimulus-specific network</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/plot_stim_spec_network.html#simulate-a-stimulus-specific-network">Simulate a stimulus-specific network</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/plot_stim_spec_network.html#stimulus-specificity-of-the-nodes-of-the-network">Stimulus-specificity of the nodes of the network</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/plot_stim_spec_network.html#stimulus-specificity-of-the-undirected-connectivity">Stimulus-specificity of the undirected connectivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/plot_stim_spec_network.html#stimulus-specificity-of-the-directed-connectivity">Stimulus-specificity of the directed connectivity</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#multi-subjects-dataset">Multi-subjects dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dataset/plot_dataset_mne.html">Define an electrophysiological dataset using MNE-Python structures</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dataset/plot_dataset_mne.html#create-artificial-data">Create artificial data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dataset/plot_dataset_mne.html#mne-conversion-to-epoch">MNE conversion to Epoch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dataset/plot_dataset_mne.html#build-the-dataset">Build the dataset</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dataset/plot_dataset_ephy.html">Build an electrophysiological dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dataset/plot_dataset_ephy.html#create-artificial-data">Create artificial data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dataset/plot_dataset_ephy.html#create-the-dataset">Create the dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dataset/plot_dataset_ephy.html#data-smoothing">Data smoothing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dataset/plot_dataset_ephy.html#temporal-slicing">Temporal slicing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dataset/plot_dataset_xarray.html">Define an electrophysiological dataset using Xarray</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dataset/plot_dataset_xarray.html#create-artificial-data">Create artificial data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dataset/plot_dataset_xarray.html#xarray-conversion-to-dataarray">Xarray conversion to DataArray</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dataset/plot_dataset_xarray.html#build-the-dataset">Build the dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dataset/plot_dataset_xarray.html#multiindex-support">MultiIndex support</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#mutual-information">Mutual-Information</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plot_wf_mi_ccd.html">MI between two continuous variables conditioned by a discret one</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_wf_mi_ccd.html#simulate-electrophysiological-data">Simulate electrophysiological data</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_wf_mi_ccd.html#extract-the-continuous-and-the-discret-variable">Extract the continuous and the discret variable</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_wf_mi_ccd.html#define-the-electrophysiological-dataset">Define the electrophysiological dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_wf_mi_ccd.html#compute-the-mutual-information">Compute the mutual information</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_wf_mi_cd.html">MI between a continuous and a discret variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_wf_mi_cd.html#simulate-electrophysiological-data">Simulate electrophysiological data</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_wf_mi_cd.html#extract-the-discret-variable">Extract the discret variable</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_wf_mi_cd.html#define-the-electrophysiological-dataset">Define the electrophysiological dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_wf_mi_cd.html#compute-the-mutual-information">Compute the mutual information</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_mi_time_frequency.html">Compute MI across time and frequencies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_mi_time_frequency.html#simulate-data">Simulate data</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_mi_time_frequency.html#compute-the-mutual-information">Compute the mutual information</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_wf_mi_cc.html">MI between two continuous variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_wf_mi_cc.html#simulate-electrophysiological-data">Simulate electrophysiological data</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_wf_mi_cc.html#extract-the-regressor-variable">Extract the regressor variable</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_wf_mi_cc.html#define-the-electrophysiological-dataset">Define the electrophysiological dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_wf_mi_cc.html#compute-the-mutual-information">Compute the mutual information</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_wf_mi_cc.html#evaluate-the-statistics">Evaluate the statistics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_mi_conjunction.html">Compute a conjunction analysis on mutual-information</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_mi_conjunction.html#define-where-to-put-an-effect-for-each-subject">Define where to put an effect for each subject</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_mi_conjunction.html#generate-the-electrophysiological-data">Generate the electrophysiological data</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_mi_conjunction.html#compute-the-mutual-information">Compute the mutual information</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_mi_conjunction.html#perform-the-conjunction-analysis">Perform the conjunction analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_mi_conjunction.html#plot-where-there-s-significant-effect-for-each-subject">Plot where thereâ€™s significant effect for each subject</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_mi_conjunction.html#plot-the-number-of-subjects-that-have-an-effect">Plot the number of subjects that have an effect</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Mutual-information at the contact level</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#i-continuous-continuous-case">I(Continuous; Continuous) case</a></li>
<li class="toctree-l4"><a class="reference internal" href="#i-continuous-discret-case">I(Continuous; Discret) case</a></li>
<li class="toctree-l4"><a class="reference internal" href="#i-continuous-continuous-discret-case">I(Continuous ; Continuous | Discret) case</a></li>
<li class="toctree-l4"><a class="reference internal" href="#xarray-definition-with-multi-indexing">Xarray definition with multi-indexing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#connectivity-and-information-transfer">Connectivity and Information Transfer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../conn/plot_dfc.html">Estimate dynamic functional connectivity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../conn/plot_dfc.html#simulate-electrophysiological-data">Simulate electrophysiological data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../conn/plot_dfc.html#simulate-spatial-correlations">Simulate spatial correlations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../conn/plot_dfc.html#define-sliding-windows">Define sliding windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="../conn/plot_dfc.html#compute-the-dfc">Compute the DFC</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../conn/plot_conn.html">Estimate comodulations between brain areas</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../conn/plot_conn.html#simulate-electrophysiological-data">Simulate electrophysiological data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../conn/plot_conn.html#simulate-spatial-correlations">Simulate spatial correlations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../conn/plot_conn.html#define-the-electrophysiological-dataset">Define the electrophysiological dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../conn/plot_conn.html#compute-the-pairwise-connectivity">Compute the pairwise connectivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../conn/plot_conn.html#plot-the-result-of-the-dataarray">Plot the result of the DataArray</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../conn/plot_covgc.html">Estimate the covariance-based Granger Causality</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../conn/plot_covgc.html#simulate-electrophysiological-data">Simulate electrophysiological data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../conn/plot_covgc.html#simulate-spatial-correlations">Simulate spatial correlations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../conn/plot_covgc.html#compute-the-covgc">Compute the covgc</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#autoregressive-model">Autoregressive model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../armodel/plot_ar_pairwise.html">AR : pairwise illustration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../armodel/plot_ar_pairwise.html#simulate-40hz-oscillations">Simulate 40hz oscillations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../armodel/plot_ar_instantaneous.html">AR : simulate common driving input</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../armodel/plot_ar_instantaneous.html#simulate-3-nodes-40hz-oscillations">Simulate 3 nodes 40hz oscillations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../armodel/plot_ar_instantaneous.html#compute-the-granger-causality">Compute the Granger-Causality</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../armodel/plot_ar_condcovgc.html">AR : conditional covariance based Granger Causality</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../armodel/plot_ar_condcovgc.html#simulate-3-nodes-40hz-oscillations">Simulate 3 nodes 40hz oscillations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../armodel/plot_ar_condcovgc.html#compute-the-granger-causality">Compute the Granger-Causality</a></li>
<li class="toctree-l4"><a class="reference internal" href="../armodel/plot_ar_condcovgc.html#direct-comparison">Direct comparison</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#utility">Utility</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/plot_time_windows.html">Define temporal windows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../utils/plot_time_windows.html#simulate-data">Simulate data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/plot_time_windows.html#manually-define-windows">Manually define windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utils/plot_time_windows.html#define-sliding-windows">Define sliding windows</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#statistics">Statistics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../statistics/plot_wf_mi_stats_compare_rfx.html">Compare between-subjects statistics when computing mutual information</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../statistics/plot_wf_mi_stats_compare_rfx.html#simulate-electrophysiological-data">Simulate electrophysiological data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../statistics/plot_wf_mi_stats_compare_rfx.html#simulate-mutual-information">Simulate mutual information</a></li>
<li class="toctree-l4"><a class="reference internal" href="../statistics/plot_wf_mi_stats_compare_rfx.html#create-an-electrophysiological-dataset">Create an electrophysiological dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../statistics/plot_wf_mi_stats_compare_rfx.html#define-the-workflow">Define the workflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../statistics/plot_wf_mi_stats_compare_rfx.html#compute-the-mutual-information-and-statistics">Compute the mutual information and statistics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../statistics/plot_wf_mi_stats_compare_ffx.html">Compare within-subjects statistics when computing mutual information</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../statistics/plot_wf_mi_stats_compare_ffx.html#simulate-electrophysiological-data">Simulate electrophysiological data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../statistics/plot_wf_mi_stats_compare_ffx.html#simulate-mutual-information">Simulate mutual information</a></li>
<li class="toctree-l4"><a class="reference internal" href="../statistics/plot_wf_mi_stats_compare_ffx.html#create-an-electrophysiological-dataset">Create an electrophysiological dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../statistics/plot_wf_mi_stats_compare_ffx.html#define-the-workflow">Define the workflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../statistics/plot_wf_mi_stats_compare_ffx.html#compute-the-mutual-information-and-statistics">Compute the mutual information and statistics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#simulations">Simulations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../simulations/plot_generate_random_data.html">Generate random electrophysiological data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../simulations/plot_generate_random_data.html#generate-electrophysiological-for-a-single-subject">Generate electrophysiological for a single subject</a></li>
<li class="toctree-l4"><a class="reference internal" href="../simulations/plot_generate_random_data.html#generate-electrophysiological-for-multiple-subjects">Generate electrophysiological for multiple subjects</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#xarray">Xarray</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../xarray/plot_xr_export.html">Xarray : Saving the results</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../xarray/plot_xr_export.html#simulate-data">Simulate data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../xarray/plot_xr_export.html#export-and-load-a-single-dataarray">Export and load a single DataArray</a></li>
<li class="toctree-l4"><a class="reference internal" href="../xarray/plot_xr_export.html#export-and-load-multiple-dataarrays">Export and load multiple DataArrays</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../xarray/plot_xr_quick_tour.html">Xarray : Quick tour</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../xarray/plot_xr_quick_tour.html#simulate-data">Simulate data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../xarray/plot_xr_quick_tour.html#xarray-conversion-and-access-to-the-internal-components">Xarray conversion and access to the internal components</a></li>
<li class="toctree-l4"><a class="reference internal" href="../xarray/plot_xr_quick_tour.html#xarray-slicing-and-indexing">Xarray slicing and indexing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../xarray/plot_xr_quick_tour.html#xarray-attributes">Xarray attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../xarray/plot_xr_quick_tour.html#xarray-to-an-other-format">Xarray to an other format</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#dataset">Dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../generated/frites.dataset.SubjectEphy.html">frites.dataset.SubjectEphy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/frites.dataset.DatasetEphy.html">frites.dataset.DatasetEphy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#workflow">Workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#task-related-workflows">Task-related workflows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.workflow.WfMi.html">frites.workflow.WfMi</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#connectivity-workflows">Connectivity workflows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.workflow.WfConnComod.html">frites.workflow.WfConnComod</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#statistical-workflows">Statistical workflows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.workflow.WfStats.html">frites.workflow.WfStats</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#connectivity">Connectivity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#connectivity-metrics">Connectivity metrics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.conn.conn_dfc.html">frites.conn.conn_dfc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.conn.conn_covgc.html">frites.conn.conn_covgc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.conn.conn_transfer_entropy.html">frites.conn.conn_transfer_entropy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#utility-functions">Utility functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.conn.conn_reshape_undirected.html">frites.conn.conn_reshape_undirected</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.conn.conn_reshape_directed.html">frites.conn.conn_reshape_directed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.conn.conn_get_pairs.html">frites.conn.conn_get_pairs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.conn.define_windows.html">frites.conn.define_windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.conn.plot_windows.html">frites.conn.plot_windows</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#information-based-estimators">Information-based estimators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#information-theoretic-estimators">Information-theoretic estimators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.estimator.GCMIEstimator.html">frites.estimator.GCMIEstimator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.estimator.BinMIEstimator.html">frites.estimator.BinMIEstimator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#distance-estimators">Distance estimators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.estimator.DcorrEstimator.html">frites.estimator.DcorrEstimator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#correlation-estimators">Correlation estimators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.estimator.CorrEstimator.html">frites.estimator.CorrEstimator</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#simulations">Simulations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#stimulus-specific-autoregressive-model">Stimulus-specific autoregressive model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.simulations.StimSpecAR.html">frites.simulations.StimSpecAR</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#single-and-multi-subjects-gaussian-based-simulations">Single and multi-subjects gaussian-based simulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.simulations.sim_local_cc_ss.html">frites.simulations.sim_local_cc_ss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.simulations.sim_local_cc_ms.html">frites.simulations.sim_local_cc_ms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.simulations.sim_local_cd_ss.html">frites.simulations.sim_local_cd_ss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.simulations.sim_local_cd_ms.html">frites.simulations.sim_local_cd_ms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.simulations.sim_local_ccd_ms.html">frites.simulations.sim_local_ccd_ms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.simulations.sim_local_ccd_ss.html">frites.simulations.sim_local_ccd_ss</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#statistics">Statistics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#random-effect-rfx">Random effect (rfx)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.stats.ttest_1samp.html">frites.stats.ttest_1samp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.stats.rfx_ttest.html">frites.stats.rfx_ttest</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#correction-for-multiple-comparisons">Correction for multiple comparisons</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.stats.cluster_correction_mcp.html">frites.stats.cluster_correction_mcp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.stats.testwise_correction_mcp.html">frites.stats.testwise_correction_mcp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.stats.cluster_threshold.html">frites.stats.cluster_threshold</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#utils">Utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../generated/frites.utils.savgol_filter.html">frites.utils.savgol_filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/frites.utils.kernel_smoothing.html">frites.utils.kernel_smoothing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../generated/frites.get_config.html">frites.get_config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/frites.set_config.html">frites.set_config</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#core">Core</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#gaussian-copula-1d">Gaussian-Copula (1d)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.copnorm_1d.html">frites.core.copnorm_1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.copnorm_cat_1d.html">frites.core.copnorm_cat_1d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.ent_1d_g.html">frites.core.ent_1d_g</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.mi_1d_gg.html">frites.core.mi_1d_gg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.mi_model_1d_gd.html">frites.core.mi_model_1d_gd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.mi_mixture_1d_gd.html">frites.core.mi_mixture_1d_gd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.cmi_1d_ggg.html">frites.core.cmi_1d_ggg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.gcmi_1d_cc.html">frites.core.gcmi_1d_cc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.gcmi_model_1d_cd.html">frites.core.gcmi_model_1d_cd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.gcmi_mixture_1d_cd.html">frites.core.gcmi_mixture_1d_cd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.gccmi_1d_ccc.html">frites.core.gccmi_1d_ccc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.gccmi_1d_ccd.html">frites.core.gccmi_1d_ccd</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#gaussian-copula-nd">Gaussian-copula (Nd)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.copnorm_nd.html">frites.core.copnorm_nd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.copnorm_cat_nd.html">frites.core.copnorm_cat_nd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.mi_nd_gg.html">frites.core.mi_nd_gg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.mi_model_nd_gd.html">frites.core.mi_model_nd_gd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.cmi_nd_ggg.html">frites.core.cmi_nd_ggg</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.gcmi_nd_cc.html">frites.core.gcmi_nd_cc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.gcmi_model_nd_cd.html">frites.core.gcmi_model_nd_cd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.gccmi_nd_ccnd.html">frites.core.gccmi_nd_ccnd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.gccmi_model_nd_cdnd.html">frites.core.gccmi_model_nd_cdnd</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/frites.core.gccmi_nd_ccc.html">frites.core.gccmi_nd_ccc</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../community.html">Community</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../community.html#ask-your-questions-and-get-some-help">Ask your questions and get some help</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../community.html#events">Events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../community.html#brainhack-marseille-2020">Brainhack Marseille 2020</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../community.html#software-presentations">Software presentations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../community.html#authors-and-contributors">Authors and contributors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../whatsnew.html">Whatâ€™s new</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../whatsnew.html#v0-4-0">v0.4.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#new-features">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#bug-fixes">Bug fixes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../whatsnew.html#v0-3-9">v0.3.9</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id3">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#internal-changes">Internal Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id10">Bug fixes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../whatsnew.html#v0-3-8">v0.3.8</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id11">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id14">Internal Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#breaking-changes">Breaking changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id15">Bug fixes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../whatsnew.html#v0-3-6">v0.3.6</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id16">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id17">Internal Changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../whatsnew.html#v0-3-5">v0.3.5</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id18">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id21">Internal Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id22">Bug fixes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../whatsnew.html#v0-3-4">v0.3.4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id23">Bug fixes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id24">Breaking changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id25">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id26">Internal Changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../whatsnew.html#v0-3-3">v0.3.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id27">Internal Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id28">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id29">Bug fixes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../whatsnew.html#v0-3-2">v0.3.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id30">Breaking changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id31">Internal Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id32">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#documentation">Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../whatsnew.html#v0-3-1">v0.3.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id33">Breaking changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id34">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id35">Bug fixes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id36">Internal Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whatsnew.html#id37">Documentation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Mutual-information at the contact level</a><ul>
<li><a class="reference internal" href="#i-continuous-continuous-case">I(Continuous; Continuous) case</a></li>
<li><a class="reference internal" href="#i-continuous-discret-case">I(Continuous; Discret) case</a></li>
<li><a class="reference internal" href="#i-continuous-continuous-discret-case">I(Continuous ; Continuous | Discret) case</a></li>
<li><a class="reference internal" href="#xarray-definition-with-multi-indexing">Xarray definition with multi-indexing</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-mi-plot-wf-mi-contact-level-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="mutual-information-at-the-contact-level">
<span id="sphx-glr-auto-examples-mi-plot-wf-mi-contact-level-py"></span><h1>Mutual-information at the contact level<a class="headerlink" href="#mutual-information-at-the-contact-level" title="Permalink to this headline">Â¶</a></h1>
<p>This example illustrates how to compute the mutual information inside each
brain region and also by taking into consideration the information at a lower
anatomical level (e.g sEEG contact, MEG sensor etc.).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="kn">from</span> <span class="nn">frites.dataset</span> <span class="kn">import</span> <a href="../../generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="View documentation for frites.dataset.DatasetEphy"><span class="n">DatasetEphy</span></a>
<span class="kn">from</span> <span class="nn">frites.workflow</span> <span class="kn">import</span> <a href="../../generated/frites.workflow.WfMi.html#frites.workflow.WfMi" title="View documentation for frites.workflow.WfMi"><span class="n">WfMi</span></a>
<span class="kn">from</span> <span class="nn">frites.core</span> <span class="kn">import</span> <span class="n">mi_nd_gg</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<section id="i-continuous-continuous-case">
<h2>I(Continuous; Continuous) case<a class="headerlink" href="#i-continuous-continuous-case" title="Permalink to this headline">Â¶</a></h2>
<p>Letâ€™s start by simulating by using random data in combination with normal
distributions. To explain why it could be interesting to consider the
information at the single contact level, we generate the data coming from one
single brain region (â€˜roi_0â€™) but with two contacts inside (â€˜c1â€™, â€˜c2â€™).
For the first the contact, the brain data are going to be positively
correlated with the normal distribution while the second contact is going to
have negative correlations. If you concatenate the data of the two contacts,
the mix of positive and negative correlations break the monotonic
assumption of the GCMI. In that case, itâ€™s better to compute the MI per
contact</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n_suj</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n_trials</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">n_times</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">half</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_trials</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_times</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">roi</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">suj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_suj</span><span class="p">):</span>
    <span class="c1"># initialize subject&#39;s data with random noise</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_times</span><span class="p">)</span>
    <span class="c1"># normal continuous regressor</span>
    <span class="n">_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,))</span>

    <span class="c1"># first contact has positive correlations</span>
    <span class="n">_x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># second contact has negative correlations</span>
    <span class="n">_x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">-=</span> <span class="n">_y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_x</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_y</span><span class="p">]</span>
    <span class="n">roi</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;roi_0&#39;</span><span class="p">,</span> <span class="s1">&#39;roi_0&#39;</span><span class="p">])]</span>

<span class="c1"># now, compute the mi with default parameters</span>
<span class="n">ds</span> <span class="o">=</span> <a href="../../generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="View documentation for frites.dataset.DatasetEphy"><span class="n">DatasetEphy</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="n">roi</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> <span class="n">agg_ch</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mi</span> <span class="o">=</span> <a href="../../generated/frites.workflow.WfMi.html#frites.workflow.WfMi" title="View documentation for frites.workflow.WfMi"><span class="n">WfMi</span></a><span class="p">(</span><span class="n">mi_type</span><span class="o">=</span><span class="s1">&#39;cc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">mcp</span><span class="o">=</span><span class="s1">&#39;noperm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># compute the mi at the contact level</span>
<span class="n">ds</span> <span class="o">=</span> <a href="../../generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="View documentation for frites.dataset.DatasetEphy"><span class="n">DatasetEphy</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="n">roi</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> <span class="n">agg_ch</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">mi_c</span> <span class="o">=</span> <a href="../../generated/frites.workflow.WfMi.html#frites.workflow.WfMi" title="View documentation for frites.workflow.WfMi"><span class="n">WfMi</span></a><span class="p">(</span><span class="n">mi_type</span><span class="o">=</span><span class="s1">&#39;ccd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">mcp</span><span class="o">=</span><span class="s1">&#39;noperm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># plot the comparison</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MI across contacts&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">mi_c</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MI at the contact level&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;I(C; C)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_wf_mi_contact_level_001.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_wf_mi_contact_level_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  0%|          | Estimating MI : 0/1 [00:00&lt;?,       ?it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   42.68it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   42.16it/s]

  0%|          | Estimating MI : 0/1 [00:00&lt;?,       ?it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   39.27it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   38.81it/s]
</pre></div>
</div>
</section>
<section id="i-continuous-discret-case">
<h2>I(Continuous; Discret) case<a class="headerlink" href="#i-continuous-discret-case" title="Permalink to this headline">Â¶</a></h2>
<p>Same example as above except that this time the MI is compute between the
data and a discret variable</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">roi</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">suj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_suj</span><span class="p">):</span>
    <span class="c1"># initialize subject&#39;s data with random noise</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_times</span><span class="p">)</span>
    <span class="c1"># define a positive and negative offsets of 1</span>
    <span class="n">_y_pos</span><span class="p">,</span> <span class="n">_y_neg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">half</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mf">1.</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">half</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="mf">1.</span><span class="p">)</span>

    <span class="c1"># first contact / first half trials : positive offset</span>
    <span class="n">_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">half</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y_pos</span>
    <span class="c1"># first contact / second half trials : negative offset</span>
    <span class="n">_x</span><span class="p">[</span><span class="n">half</span><span class="p">::,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y_neg</span>
    <span class="c1"># second contact / first half trials : negative offset</span>
    <span class="n">_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">half</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y_neg</span>
    <span class="c1"># second contact / second half trials : positive offset</span>
    <span class="n">_x</span><span class="p">[</span><span class="n">half</span><span class="p">::,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y_pos</span>

    <span class="n">x</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_x</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">half</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">half</span><span class="p">)]</span>
    <span class="n">roi</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;roi_0&#39;</span><span class="p">,</span> <span class="s1">&#39;roi_0&#39;</span><span class="p">])]</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_times</span><span class="p">)</span>

<span class="c1"># now, compute the mi with default parameters</span>
<span class="n">ds</span> <span class="o">=</span> <a href="../../generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="View documentation for frites.dataset.DatasetEphy"><span class="n">DatasetEphy</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="n">roi</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">)</span>
<span class="n">mi</span> <span class="o">=</span> <a href="../../generated/frites.workflow.WfMi.html#frites.workflow.WfMi" title="View documentation for frites.workflow.WfMi"><span class="n">WfMi</span></a><span class="p">(</span><span class="n">mi_type</span><span class="o">=</span><span class="s1">&#39;cd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">mcp</span><span class="o">=</span><span class="s1">&#39;noperm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># compute the mi at the contact level</span>
<span class="n">ds</span> <span class="o">=</span> <a href="../../generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="View documentation for frites.dataset.DatasetEphy"><span class="n">DatasetEphy</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="n">roi</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> <span class="n">agg_ch</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">mi_c</span> <span class="o">=</span> <a href="../../generated/frites.workflow.WfMi.html#frites.workflow.WfMi" title="View documentation for frites.workflow.WfMi"><span class="n">WfMi</span></a><span class="p">(</span><span class="n">mi_type</span><span class="o">=</span><span class="s1">&#39;cd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">mcp</span><span class="o">=</span><span class="s1">&#39;noperm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># plot the comparison</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MI across contacts&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">mi_c</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MI at the contact level&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;I(C; D)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_wf_mi_contact_level_002.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_wf_mi_contact_level_002.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  0%|          | Estimating MI : 0/1 [00:00&lt;?,       ?it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   42.36it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   41.86it/s]

  0%|          | Estimating MI : 0/1 [00:00&lt;?,       ?it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   40.38it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   39.90it/s]
</pre></div>
</div>
</section>
<section id="i-continuous-continuous-discret-case">
<h2>I(Continuous ; Continuous | Discret) case<a class="headerlink" href="#i-continuous-continuous-discret-case" title="Permalink to this headline">Â¶</a></h2>
<p>Same example as above except that this time the MI is compute between the
data and a discret variable</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">roi</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">suj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_suj</span><span class="p">):</span>
    <span class="c1"># initialize subject&#39;s data with random noise</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_times</span><span class="p">)</span>
    <span class="c1"># define a positive and negative correlations</span>
    <span class="n">_y_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">half</span><span class="p">))</span>
    <span class="n">_y_neg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">half</span><span class="p">))</span>
    <span class="n">_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">_y_pos</span><span class="p">,</span> <span class="n">_y_neg</span><span class="p">]</span>
    <span class="n">_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">half</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">half</span><span class="p">)</span>

    <span class="c1"># first contact / first half trials : positive offset</span>
    <span class="n">_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">half</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y_pos</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># first contact / second half trials : negative offset</span>
    <span class="n">_x</span><span class="p">[</span><span class="n">half</span><span class="p">::,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y_neg</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># second contact / first half trials : negative offset</span>
    <span class="n">_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">half</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y_neg</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># second contact / second half trials : positive offset</span>
    <span class="n">_x</span><span class="p">[</span><span class="n">half</span><span class="p">::,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y_pos</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_x</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_y</span><span class="p">]</span>
    <span class="n">z</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_z</span><span class="p">]</span>
    <span class="n">roi</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;roi_0&#39;</span><span class="p">,</span> <span class="s1">&#39;roi_0&#39;</span><span class="p">])]</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_times</span><span class="p">)</span>

<span class="c1"># now, compute the mi with default parameters</span>
<span class="n">ds</span> <span class="o">=</span> <a href="../../generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="View documentation for frites.dataset.DatasetEphy"><span class="n">DatasetEphy</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="n">roi</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">)</span>
<span class="n">mi</span> <span class="o">=</span> <a href="../../generated/frites.workflow.WfMi.html#frites.workflow.WfMi" title="View documentation for frites.workflow.WfMi"><span class="n">WfMi</span></a><span class="p">(</span><span class="n">mi_type</span><span class="o">=</span><span class="s1">&#39;ccd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">mcp</span><span class="o">=</span><span class="s1">&#39;noperm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># compute the mi at the contact level</span>
<span class="n">ds</span> <span class="o">=</span> <a href="../../generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="View documentation for frites.dataset.DatasetEphy"><span class="n">DatasetEphy</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="n">roi</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> <span class="n">agg_ch</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">mi_c</span> <span class="o">=</span> <a href="../../generated/frites.workflow.WfMi.html#frites.workflow.WfMi" title="View documentation for frites.workflow.WfMi"><span class="n">WfMi</span></a><span class="p">(</span><span class="n">mi_type</span><span class="o">=</span><span class="s1">&#39;ccd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">mcp</span><span class="o">=</span><span class="s1">&#39;noperm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># plot the comparison</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MI across contacts&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">mi_c</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MI at the contact level&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;I(C; C | D)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_wf_mi_contact_level_003.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_wf_mi_contact_level_003.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  0%|          | Estimating MI : 0/1 [00:00&lt;?,       ?it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   39.54it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   39.09it/s]

  0%|          | Estimating MI : 0/1 [00:00&lt;?,       ?it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   35.76it/s]
100%|##########| Estimating MI : 1/1 [00:00&lt;00:00,   35.39it/s]
</pre></div>
</div>
</section>
<section id="xarray-definition-with-multi-indexing">
<h2>Xarray definition with multi-indexing<a class="headerlink" href="#xarray-definition-with-multi-indexing" title="Permalink to this headline">Â¶</a></h2>
<p>Finally, we show below how to use Xarray in combination with pandas
multi-index to define an electrophysiological dataset</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">suj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_suj</span><span class="p">):</span>
    <span class="c1"># initialize subject&#39;s data with random noise</span>
    <span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_times</span><span class="p">)</span>
    <span class="c1"># normal continuous regressor</span>
    <span class="n">_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,))</span>

    <span class="c1"># first contact has positive correlations</span>
    <span class="n">_x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">_y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># second contact has negative correlations</span>
    <span class="n">_x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">)]</span> <span class="o">-=</span> <span class="n">_y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># roi and contacts definitions</span>
    <span class="n">_roi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;roi_0&#39;</span><span class="p">,</span> <span class="s1">&#39;roi_0&#39;</span><span class="p">])</span>
    <span class="n">_contacts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;c1&#39;</span><span class="p">,</span> <span class="s1">&#39;c2&#39;</span><span class="p">])</span>

    <span class="c1"># multi-index definition</span>
    <span class="n">midx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span><span class="n">_roi</span><span class="p">,</span> <span class="n">_contacts</span><span class="p">],</span>
                                     <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;parcel&#39;</span><span class="p">,</span> <span class="s1">&#39;contacts&#39;</span><span class="p">))</span>
    <span class="c1"># xarray definition</span>
    <span class="n">_x_xr</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;trials&#39;</span><span class="p">,</span> <span class="s1">&#39;space&#39;</span><span class="p">,</span> <span class="s1">&#39;times&#39;</span><span class="p">),</span>
                         <span class="n">coords</span><span class="o">=</span><span class="p">(</span><span class="n">_y</span><span class="p">,</span> <span class="n">midx</span><span class="p">,</span> <span class="n">times</span><span class="p">))</span>

    <span class="n">x</span> <span class="o">+=</span> <span class="p">[</span><span class="n">_x_xr</span><span class="p">]</span>

<span class="c1"># finally, define the electrophysiological dataset and specify the dimension</span>
<span class="c1"># names to use</span>
<span class="n">ds_xr</span> <span class="o">=</span> <a href="../../generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="View documentation for frites.dataset.DatasetEphy"><span class="n">DatasetEphy</span></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;trials&#39;</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="s1">&#39;parcel&#39;</span><span class="p">,</span> <span class="n">agg_ch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="s1">&#39;times&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ds_xr</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;xarray.DataArray &#39;subject_0&#39; (trials: 20, roi: 2, times: 100)&gt;
array([[[0.56040774, 0.28117453, 0.52088179, ..., 0.94512574,
         0.95866817, 0.78940242],
        [0.53544573, 0.43754886, 0.30670626, ..., 0.53584365,
         0.28057439, 0.12717791]],

       [[0.52074291, 0.339492  , 0.65152336, ..., 0.42760885,
         0.55458026, 0.74008738],
        [0.99180603, 0.44158645, 0.65748555, ..., 0.53295643,
         0.59884127, 0.6960487 ]],

       [[0.41427776, 0.89115107, 0.84310484, ..., 0.28495053,
         0.86582938, 0.06203336],
        [0.56004283, 0.26659584, 0.15214449, ..., 0.51412215,
         0.41725579, 0.56547714]],

       ...,

       [[0.09385502, 0.9368618 , 0.67886889, ..., 0.94413044,
         0.76157604, 0.13948916],
        [0.63949941, 0.21077103, 0.01404759, ..., 0.94003118,
         0.16265805, 0.47284531]],

       [[0.88206698, 0.71067   , 0.23378737, ..., 0.61755073,
         0.28848188, 0.29526831],
        [0.14426993, 0.44192917, 0.18073842, ..., 0.2178995 ,
         0.32460352, 0.38441177]],

       [[0.23047092, 0.71888612, 0.84063236, ..., 0.80062377,
         0.05211592, 0.27126727],
        [0.15502715, 0.33200068, 0.16684851, ..., 0.76772919,
         0.59001285, 0.12377169]]])
Coordinates:
  * trials   (trials) int64 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19
    y        (trials) float64 0.5469 -1.006 -0.6625 ... 1.879 0.6576 0.02658
  * roi      (roi) object &#39;roi_0&#39; &#39;roi_0&#39;
    agg_ch   (roi) int64 0 1
  * times    (times) int64 0 1 2 3 4 5 6 7 8 9 ... 90 91 92 93 94 95 96 97 98 99
    subject  (trials) int64 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
Attributes:
    __version__:   0.3.9
    modality:      electrophysiology
    dtype:         SubjectEphy
    y_dtype:       float
    z_dtype:       none
    mi_type:       cc
    mi_repr:       I(x; y (continuous))
    sfreq:         1.0
    agg_ch:        True
    multivariate:  False
&lt;xarray.DataArray &#39;subject_1&#39; (trials: 20, roi: 2, times: 100)&gt;
array([[[8.90039779e-01, 9.19466316e-01, 8.21236794e-01, ...,
         6.32930437e-01, 3.52211824e-01, 6.96441458e-01],
        [3.86844041e-01, 5.36376936e-01, 9.51176372e-01, ...,
         7.00227559e-01, 3.71208235e-01, 1.05570924e-01]],

       [[1.53340955e-01, 8.29216346e-01, 1.01345880e-01, ...,
         9.82338981e-01, 9.62681755e-02, 8.14109284e-01],
        [4.31654670e-01, 6.19026687e-01, 9.67607882e-01, ...,
         5.00425400e-01, 4.56829272e-01, 6.42263176e-01]],

       [[4.69528763e-01, 2.69785675e-01, 6.82829256e-01, ...,
         2.26236022e-01, 7.04391326e-01, 1.01376098e-01],
        [5.31955236e-01, 4.98312374e-01, 9.18412026e-01, ...,
         6.25119686e-03, 5.28302779e-01, 8.58719012e-02]],

       ...,

       [[6.34196334e-03, 2.44212124e-01, 1.94921999e-01, ...,
         4.74999499e-01, 1.90318451e-01, 3.21849061e-01],
        [1.91878868e-01, 3.84710709e-01, 9.90222054e-01, ...,
         2.31483669e-01, 1.40051880e-04, 7.22737495e-01]],

       [[8.17000650e-01, 6.28246660e-01, 1.45467362e-01, ...,
         6.93257839e-01, 2.31776800e-01, 9.35225243e-01],
        [4.77064449e-01, 6.78557060e-01, 9.04930262e-01, ...,
         9.59066454e-01, 6.80134486e-01, 4.41983189e-01]],

       [[1.65876993e-01, 3.16622299e-02, 2.32988977e-01, ...,
         1.19722329e-01, 1.07618230e-01, 8.66270978e-01],
        [5.17890639e-01, 2.10949442e-02, 5.12575238e-01, ...,
         8.60881900e-02, 8.83697495e-01, 9.67984104e-01]]])
Coordinates:
  * trials   (trials) int64 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19
    y        (trials) float64 -0.2141 -0.3485 -0.4278 ... 0.9418 -1.454 -0.3208
  * roi      (roi) object &#39;roi_0&#39; &#39;roi_0&#39;
    agg_ch   (roi) int64 2 3
  * times    (times) int64 0 1 2 3 4 5 6 7 8 9 ... 90 91 92 93 94 95 96 97 98 99
    subject  (trials) int64 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
Attributes:
    __version__:   0.3.9
    modality:      electrophysiology
    dtype:         SubjectEphy
    y_dtype:       float
    z_dtype:       none
    mi_type:       cc
    mi_repr:       I(x; y (continuous))
    sfreq:         1.0
    agg_ch:        True
    multivariate:  False
&lt;xarray.DataArray &#39;subject_2&#39; (trials: 20, roi: 2, times: 100)&gt;
array([[[0.06820251, 0.9928669 , 0.91453564, ..., 0.86823597,
         0.16110701, 0.83469725],
        [0.36663384, 0.05893865, 0.57298651, ..., 0.21507821,
         0.30332323, 0.03791868]],

       [[0.26988679, 0.55891195, 0.629232  , ..., 0.36352503,
         0.51144101, 0.91714537],
        [0.53761664, 0.2315994 , 0.06632258, ..., 0.68320104,
         0.66988669, 0.73517916]],

       [[0.09296876, 0.46367085, 0.05381933, ..., 0.06803223,
         0.05061179, 0.31825044],
        [0.57574113, 0.37339633, 0.53171601, ..., 0.21350775,
         0.78025998, 0.98586896]],

       ...,

       [[0.01275653, 0.42919206, 0.65191971, ..., 0.85689755,
         0.58634898, 0.47348363],
        [0.08299673, 0.32211196, 0.0220334 , ..., 0.24889365,
         0.65346191, 0.9723311 ]],

       [[0.80998223, 0.43580244, 0.36680314, ..., 0.0030579 ,
         0.33352381, 0.57252568],
        [0.45884706, 0.92960988, 0.69411878, ..., 0.06938666,
         0.10881912, 0.25568863]],

       [[0.02251151, 0.36911705, 0.22568252, ..., 0.13131932,
         0.69157669, 0.72327741],
        [0.64746532, 0.12817753, 0.06093025, ..., 0.08888644,
         0.69399612, 0.84870733]]])
Coordinates:
  * trials   (trials) int64 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19
    y        (trials) float64 1.044 -0.5556 -2.0 1.305 ... 0.7155 0.8358 -1.115
  * roi      (roi) object &#39;roi_0&#39; &#39;roi_0&#39;
    agg_ch   (roi) int64 4 5
  * times    (times) int64 0 1 2 3 4 5 6 7 8 9 ... 90 91 92 93 94 95 96 97 98 99
    subject  (trials) int64 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
Attributes:
    __version__:   0.3.9
    modality:      electrophysiology
    dtype:         SubjectEphy
    y_dtype:       float
    z_dtype:       none
    mi_type:       cc
    mi_repr:       I(x; y (continuous))
    sfreq:         1.0
    agg_ch:        True
    multivariate:  False
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.737 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-mi-plot-wf-mi-contact-level-py">
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/23497494d94c2d1ff4ef55c6e8ee1397/plot_wf_mi_contact_level.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_wf_mi_contact_level.py</span></code></a></p>
</div>
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/66081c9fb93014c1bdfccab1eccfba52/plot_wf_mi_contact_level.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_wf_mi_contact_level.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
    <hr>
    <footer>
        <div class="container">
            <img src="../../_static/baniere.png" alt="Ban" height="80">
        </div>
        <br>
        <div class="container">
            <ul class="list-inline">
                <li style="font-weight:bold"><a href="../../genindex.html">Index</a></li>
                <li>Â·</li>
                <li style="font-weight:bold"><a href="../../whatsnew.html">What's new</a></li>
                <li>Â·</li>
                <li style="font-weight:bold"><a href="https://github.com/brainets/frites">Github</a></li>
                <li>Â·</li>
                <li style="font-weight:bold"><a href="../../community.html">Community</a></li>
                <li>Â·</li>
                <li style="font-weight:bold"><a href="../../references.html">References</a></li>
            </ul>
         </div>
        <!-- <br> -->
        <p>&copy; Copyright Last updated on 2021-06-07.</p>
    </footer>

  </body>
</html>