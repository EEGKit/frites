
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Define an electrophysiological dataset using Xarray &#8212; frites 0.4.0 documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/blank.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/frites_style.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="MI between two continuous variables conditioned by a discret one" href="../mi/plot_wf_mi_ccd.html" />
    <link rel="prev" title="Build an electrophysiological dataset" href="plot_dataset_ephy.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
<head>
<style>
@import url('https://fonts.googleapis.com/css2?family=Maven+Pro&family=Roboto+Mono:wght@332&display=swap');
</style>
</head>

    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/frites_top.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../overview/index.html">
  Overview
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../install.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../api/index.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../index.html">
  Examples
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/brainets/frites" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/kNearNeighbors" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/plot_dfc_estimator.html">
   Estimate the Dynamic Functional Connectivity
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/plot_stim_spec_network.html">
   Statistical analysis of a stimulus-specific network
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_dataset_mne.html">
   Define an electrophysiological dataset using MNE-Python structures
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_dataset_ephy.html">
   Build an electrophysiological dataset
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Define an electrophysiological dataset using Xarray
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../mi/plot_wf_mi_ccd.html">
   MI between two continuous variables conditioned by a discret one
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../mi/plot_wf_mi_cd.html">
   MI between a continuous and a discret variables
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../mi/plot_mi_time_frequency.html">
   Compute MI across time and frequencies
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../mi/plot_wf_mi_cc.html">
   MI between two continuous variables
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../mi/plot_wf_mi_combine.html">
   Investigate relation of order
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../mi/plot_mi_conjunction.html">
   Compute a conjunction analysis on mutual-information
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../mi/plot_wf_mi_contact_level.html">
   Mutual-information at the contact level
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../estimators/plot_est_resample.html">
   Trial-resampling: correcting for unbalanced designs
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../estimators/plot_est_custom.html">
   Defining a custom estimator
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../estimators/plot_est_comparison.html">
   Estimator comparison
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../conn/plot_dfc.html">
   Estimate dynamic functional connectivity
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../conn/plot_conn.html">
   Estimate comodulations between brain areas
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../conn/plot_ccf.html">
   Lag estimation between delayed times-series using the cross-correlation
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../conn/plot_covgc.html">
   Estimate the covariance-based Granger Causality
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../armodel/plot_ar_pairwise.html">
   AR : pairwise illustration
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../armodel/plot_ar_instantaneous.html">
   AR : simulate common driving input
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../armodel/plot_ar_condcovgc.html">
   AR : conditional covariance based Granger Causality
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../utils/plot_time_windows.html">
   Define temporal windows
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../statistics/plot_wf_mi_stats_compare_rfx.html">
   Compare between-subjects statistics when computing mutual information
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../statistics/plot_wf_mi_stats_compare_ffx.html">
   Compare within-subjects statistics when computing mutual information
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../simulations/plot_generate_random_data.html">
   Generate random electrophysiological data
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../xarray/plot_xr_export.html">
   Xarray : Saving the results
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../xarray/plot_xr_quick_tour.html">
   Xarray : Quick tour
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-artificial-data">
   Create artificial data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#xarray-conversion-to-dataarray">
   Xarray conversion to DataArray
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#build-the-dataset">
   Build the dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiindex-support">
   MultiIndex support
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-dataset-plot-dataset-xarray-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="define-an-electrophysiological-dataset-using-xarray">
<span id="sphx-glr-auto-examples-dataset-plot-dataset-xarray-py"></span><h1>Define an electrophysiological dataset using Xarray<a class="headerlink" href="#define-an-electrophysiological-dataset-using-xarray" title="Permalink to this headline">¶</a></h1>
<p>This example illustrates how to define a dataset using Xarray. If you don’t
know this library, we can simplify by saying that it provides containers that
accept arrays but you can also labelize your dimensions. Another way of seeing
it, pandas is mostly made for tables (i.e 2D arrays) while Xarray provide
almost the same functionalities but for multi-dimensional arrays.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">xarray</span> <span class="kn">import</span> <span class="n">DataArray</span>
<span class="kn">from</span> <span class="nn">frites.dataset</span> <span class="kn">import</span> <a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class"><span class="n">DatasetEphy</span></a>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<section id="create-artificial-data">
<h2>Create artificial data<a class="headerlink" href="#create-artificial-data" title="Permalink to this headline">¶</a></h2>
<p>We start by creating some random data for several subjects. To do that, each
subject is going have a 3 dimensional array of shape
(n_epochs, n_channels, n_times). Then, all of the arrays are grouped together
in a list of length (n_subjects,)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n_subjects</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">n_channels</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_times</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">sf</span> <span class="o">=</span> <span class="mi">512</span>

<span class="n">x</span><span class="p">,</span> <span class="n">ch</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_subjects</span><span class="p">):</span>
    <span class="c1"># generate single subject data</span>
    <span class="n">x_suj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">,</span> <span class="n">n_times</span><span class="p">)</span>
    <span class="c1"># generate some random channel names</span>
    <span class="n">ch_suj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;ch_</span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_channels</span><span class="p">)])</span>
    <span class="c1"># concatenate in a list</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_suj</span><span class="p">)</span>
    <span class="n">ch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ch_suj</span><span class="p">)</span>
<span class="c1"># finally lets create a time vector</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_times</span><span class="p">)</span> <span class="o">/</span> <span class="n">sf</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="xarray-conversion-to-dataarray">
<h2>Xarray conversion to DataArray<a class="headerlink" href="#xarray-conversion-to-dataarray" title="Permalink to this headline">¶</a></h2>
<p>Here, we convert the NumPy arrays to xarray.DataArray</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x_xr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_subjects</span><span class="p">):</span>
    <span class="c1"># DataArray conversion</span>
    <span class="n">arr_xr</span> <span class="o">=</span> <span class="n">DataArray</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;epochs&#39;</span><span class="p">,</span> <span class="s1">&#39;channels&#39;</span><span class="p">,</span> <span class="s1">&#39;times&#39;</span><span class="p">),</span>
                       <span class="n">coords</span><span class="o">=</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">ch</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">times</span><span class="p">))</span>
    <span class="c1"># finally, replace it in the original list</span>
    <span class="n">x_xr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arr_xr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_xr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;xarray.DataArray (epochs: 10, channels: 5, times: 100)&gt;
array([[[0.24034329, 0.86171632, 0.34465303, ..., 0.54380438,
         0.63095761, 0.93720225],
        [0.61478264, 0.52128619, 0.06160772, ..., 0.20270607,
         0.00419284, 0.05594515],
        [0.91303176, 0.1706054 , 0.8651436 , ..., 0.81004235,
         0.3997639 , 0.34532053],
        [0.65921565, 0.98308403, 0.21330509, ..., 0.70466384,
         0.26965635, 0.85455873],
        [0.23678831, 0.46494301, 0.17812426, ..., 0.06969955,
         0.80267041, 0.40547512]],

       [[0.91072037, 0.99845745, 0.15396403, ..., 0.45497848,
         0.36994284, 0.83810365],
        [0.23316428, 0.94316217, 0.08442595, ..., 0.74669753,
         0.87746451, 0.391663  ],
        [0.10406672, 0.45866321, 0.7006282 , ..., 0.4829847 ,
         0.16199675, 0.83818631],
        [0.29406866, 0.00558673, 0.49541342, ..., 0.72562022,
         0.03051609, 0.8177315 ],
        [0.25638312, 0.79927744, 0.40130464, ..., 0.95306325,
...
         0.90549455, 0.03376424],
        [0.29453596, 0.52700977, 0.89888307, ..., 0.01805061,
         0.70565441, 0.54270608],
        [0.88223672, 0.52676527, 0.55937031, ..., 0.82115104,
         0.65574706, 0.74626048],
        [0.28772564, 0.39692847, 0.67759423, ..., 0.45044822,
         0.46511742, 0.60031231],
        [0.57433969, 0.43456222, 0.11748138, ..., 0.55597682,
         0.62714934, 0.61510998]],

       [[0.82983166, 0.83912682, 0.17667505, ..., 0.30211243,
         0.12577888, 0.59710437],
        [0.93456962, 0.47027299, 0.26927959, ..., 0.412699  ,
         0.86340372, 0.93950113],
        [0.90775143, 0.38248679, 0.14104779, ..., 0.0882851 ,
         0.76647458, 0.05708595],
        [0.26975885, 0.66982987, 0.25147766, ..., 0.57987697,
         0.24410713, 0.92257136],
        [0.75240244, 0.67120867, 0.76360982, ..., 0.45137771,
         0.01442582, 0.69954964]]])
Coordinates:
  * epochs    (epochs) int64 0 1 2 3 4 5 6 7 8 9
  * channels  (channels) &lt;U4 &#39;ch_0&#39; &#39;ch_1&#39; &#39;ch_2&#39; &#39;ch_3&#39; &#39;ch_4&#39;
  * times     (times) float64 0.0 0.001953 0.003906 ... 0.1895 0.1914 0.1934
</pre></div>
</div>
</section>
<section id="build-the-dataset">
<h2>Build the dataset<a class="headerlink" href="#build-the-dataset" title="Permalink to this headline">¶</a></h2>
<p>Finally, we pass the data to the <a class="reference internal" href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy"><code class="xref py py-class docutils literal notranslate"><span class="pre">frites.dataset.DatasetEphy</span></code></a> class
in order to create the dataset</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># here, we specify to the DatasetEphy class that the roi dimension is actually</span>
<span class="c1"># called &#39;channels&#39; in the DataArray and the times dimension is called &#39;times&#39;</span>
<a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dt</span></a> <span class="o">=</span> <a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class"><span class="n">DatasetEphy</span></a><span class="p">(</span><span class="n">x_xr</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="s1">&#39;channels&#39;</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="s1">&#39;times&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dt</span></a><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Time vector : &#39;</span><span class="p">,</span> <a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy.times" title="frites.dataset.DatasetEphy.times" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-property"><span class="n">dt</span><span class="o">.</span><span class="n">times</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ROI</span><span class="se">\n</span><span class="s1">: &#39;</span><span class="p">,</span> <a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy.df_rs" title="frites.dataset.DatasetEphy.df_rs" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-property"><span class="n">dt</span><span class="o">.</span><span class="n">df_rs</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;xarray.DataArray &#39;subject_0&#39; (trials: 10, roi: 5, times: 100)&gt;
array([[[0.24034329, 0.86171632, 0.34465303, ..., 0.54380438,
         0.63095761, 0.93720225],
        [0.61478264, 0.52128619, 0.06160772, ..., 0.20270607,
         0.00419284, 0.05594515],
        [0.91303176, 0.1706054 , 0.8651436 , ..., 0.81004235,
         0.3997639 , 0.34532053],
        [0.65921565, 0.98308403, 0.21330509, ..., 0.70466384,
         0.26965635, 0.85455873],
        [0.23678831, 0.46494301, 0.17812426, ..., 0.06969955,
         0.80267041, 0.40547512]],

       [[0.91072037, 0.99845745, 0.15396403, ..., 0.45497848,
         0.36994284, 0.83810365],
        [0.23316428, 0.94316217, 0.08442595, ..., 0.74669753,
         0.87746451, 0.391663  ],
        [0.10406672, 0.45866321, 0.7006282 , ..., 0.4829847 ,
         0.16199675, 0.83818631],
        [0.29406866, 0.00558673, 0.49541342, ..., 0.72562022,
         0.03051609, 0.8177315 ],
        [0.25638312, 0.79927744, 0.40130464, ..., 0.95306325,
...
         0.90549455, 0.03376424],
        [0.29453596, 0.52700977, 0.89888307, ..., 0.01805061,
         0.70565441, 0.54270608],
        [0.88223672, 0.52676527, 0.55937031, ..., 0.82115104,
         0.65574706, 0.74626048],
        [0.28772564, 0.39692847, 0.67759423, ..., 0.45044822,
         0.46511742, 0.60031231],
        [0.57433969, 0.43456222, 0.11748138, ..., 0.55597682,
         0.62714934, 0.61510998]],

       [[0.82983166, 0.83912682, 0.17667505, ..., 0.30211243,
         0.12577888, 0.59710437],
        [0.93456962, 0.47027299, 0.26927959, ..., 0.412699  ,
         0.86340372, 0.93950113],
        [0.90775143, 0.38248679, 0.14104779, ..., 0.0882851 ,
         0.76647458, 0.05708595],
        [0.26975885, 0.66982987, 0.25147766, ..., 0.57987697,
         0.24410713, 0.92257136],
        [0.75240244, 0.67120867, 0.76360982, ..., 0.45137771,
         0.01442582, 0.69954964]]])
Coordinates:
  * trials   (trials) int64 0 1 2 3 4 5 6 7 8 9
  * roi      (roi) &lt;U4 &#39;ch_0&#39; &#39;ch_1&#39; &#39;ch_2&#39; &#39;ch_3&#39; &#39;ch_4&#39;
    agg_ch   (roi) int64 0 0 0 0 0
  * times    (times) float64 0.0 0.001953 0.003906 ... 0.1895 0.1914 0.1934
    subject  (trials) int64 0 0 0 0 0 0 0 0 0 0
Attributes:
    __version__:   0.4.0
    modality:      electrophysiology
    dtype:         SubjectEphy
    y_dtype:       none
    z_dtype:       none
    mi_type:       none
    mi_repr:       none
    sfreq:         512.0
    agg_ch:        True
    multivariate:  False
&lt;xarray.DataArray &#39;subject_1&#39; (trials: 10, roi: 5, times: 100)&gt;
array([[[0.72175429, 0.75050817, 0.46214228, ..., 0.23128801,
         0.7267556 , 0.15987162],
        [0.98850847, 0.07344707, 0.52882055, ..., 0.64100186,
         0.30747571, 0.78058408],
        [0.9617843 , 0.77987935, 0.67254554, ..., 0.06091654,
         0.64701474, 0.01464767],
        [0.92468401, 0.80944684, 0.52712878, ..., 0.70166188,
         0.41720549, 0.45291127],
        [0.00520981, 0.01264942, 0.14240944, ..., 0.54996108,
         0.69567786, 0.99838839]],

       [[0.53517998, 0.12297555, 0.6055163 , ..., 0.38636983,
         0.27551176, 0.44586167],
        [0.96107471, 0.47987983, 0.81127746, ..., 0.90794777,
         0.59548204, 0.48741044],
        [0.90442449, 0.38221534, 0.67588997, ..., 0.22137111,
         0.47973779, 0.05600166],
        [0.67316509, 0.40358586, 0.51229431, ..., 0.81150807,
         0.65740563, 0.96299191],
        [0.08816517, 0.04345994, 0.01074248, ..., 0.40064736,
...
         0.94873875, 0.61944821],
        [0.91220839, 0.7291937 , 0.47878479, ..., 0.14131304,
         0.30985056, 0.62878864],
        [0.86376133, 0.46284292, 0.36097113, ..., 0.50370121,
         0.65944701, 0.20340871],
        [0.06881119, 0.87651879, 0.94823707, ..., 0.46366507,
         0.31924642, 0.92000456],
        [0.7331217 , 0.04967909, 0.79917134, ..., 0.55610828,
         0.15168246, 0.66038551]],

       [[0.97445161, 0.72366698, 0.64587503, ..., 0.513926  ,
         0.05303286, 0.94357372],
        [0.63532865, 0.1929775 , 0.5008863 , ..., 0.63650841,
         0.05092242, 0.58395556],
        [0.2794173 , 0.90774889, 0.78718551, ..., 0.50235677,
         0.26504078, 0.52206471],
        [0.49535186, 0.72798647, 0.44225394, ..., 0.55838299,
         0.11216199, 0.48820217],
        [0.99845411, 0.27739505, 0.23103634, ..., 0.39763765,
         0.33448149, 0.87292421]]])
Coordinates:
  * trials   (trials) int64 0 1 2 3 4 5 6 7 8 9
  * roi      (roi) &lt;U4 &#39;ch_0&#39; &#39;ch_1&#39; &#39;ch_2&#39; &#39;ch_3&#39; &#39;ch_4&#39;
    agg_ch   (roi) int64 0 0 0 0 0
  * times    (times) float64 0.0 0.001953 0.003906 ... 0.1895 0.1914 0.1934
    subject  (trials) int64 1 1 1 1 1 1 1 1 1 1
Attributes:
    __version__:   0.4.0
    modality:      electrophysiology
    dtype:         SubjectEphy
    y_dtype:       none
    z_dtype:       none
    mi_type:       none
    mi_repr:       none
    sfreq:         512.0
    agg_ch:        True
    multivariate:  False
&lt;xarray.DataArray &#39;subject_2&#39; (trials: 10, roi: 5, times: 100)&gt;
array([[[1.19276916e-01, 9.25926167e-01, 3.67923683e-01, ...,
         9.77667193e-01, 2.86834824e-01, 4.92570237e-01],
        [7.65460747e-01, 1.62682369e-01, 6.56098667e-01, ...,
         2.91057917e-02, 7.58385354e-01, 3.90439643e-01],
        [3.59773834e-01, 1.13549616e-01, 1.28944246e-01, ...,
         9.47228805e-01, 2.76226848e-01, 3.81999824e-01],
        [5.89701332e-01, 6.30959884e-01, 1.37658164e-01, ...,
         2.97218295e-01, 7.50627378e-01, 2.92407654e-01],
        [2.84331203e-01, 1.88682815e-01, 5.72338268e-01, ...,
         2.71812864e-01, 2.15703332e-01, 9.31655783e-01]],

       [[1.82036693e-01, 9.57333041e-01, 5.17804989e-01, ...,
         6.94780424e-01, 4.90429921e-01, 5.52295408e-02],
        [1.21880929e-01, 5.86447180e-02, 8.61178933e-01, ...,
         6.95953042e-01, 9.18069001e-01, 5.83163865e-01],
        [9.27879930e-02, 5.74393310e-01, 6.83139068e-01, ...,
         3.59976102e-01, 3.18923282e-01, 8.21112466e-01],
        [5.88571550e-01, 1.02237400e-01, 6.92993238e-01, ...,
         7.29893703e-01, 9.16487603e-01, 7.58929882e-01],
        [4.64238812e-01, 4.66104724e-01, 3.49163801e-01, ...,
...
         7.22764282e-02, 9.24947099e-01, 9.94352466e-01],
        [6.19132284e-01, 1.52396512e-01, 1.39604737e-01, ...,
         5.44731664e-01, 8.65210267e-01, 8.33013793e-01],
        [3.31069424e-01, 1.23843879e-01, 3.08726593e-01, ...,
         1.54972803e-02, 4.33156531e-05, 1.09682827e-01],
        [9.53495998e-01, 4.00622578e-01, 5.49231079e-01, ...,
         2.07248956e-01, 3.04258281e-01, 3.28841265e-01],
        [9.47793597e-01, 5.23480737e-01, 3.68108879e-01, ...,
         3.28135371e-02, 5.22654365e-01, 9.95355833e-01]],

       [[4.86929633e-01, 6.72755627e-01, 3.76705987e-01, ...,
         3.78288637e-01, 4.59351282e-01, 9.84596215e-01],
        [7.76291622e-01, 5.68684135e-01, 2.69774072e-01, ...,
         7.54182740e-01, 7.58927804e-01, 3.60972499e-01],
        [3.35087956e-01, 8.90568020e-01, 4.94091783e-01, ...,
         2.43007441e-01, 2.65921644e-01, 8.65626711e-01],
        [6.57981650e-01, 4.90625838e-01, 9.75015885e-01, ...,
         1.19363862e-01, 2.93435674e-02, 3.69337115e-01],
        [2.78689259e-01, 1.59496976e-01, 4.72344087e-01, ...,
         9.84379481e-01, 6.54795053e-01, 8.44844248e-01]]])
Coordinates:
  * trials   (trials) int64 0 1 2 3 4 5 6 7 8 9
  * roi      (roi) &lt;U4 &#39;ch_0&#39; &#39;ch_1&#39; &#39;ch_2&#39; &#39;ch_3&#39; &#39;ch_4&#39;
    agg_ch   (roi) int64 0 0 0 0 0
  * times    (times) float64 0.0 0.001953 0.003906 ... 0.1895 0.1914 0.1934
    subject  (trials) int64 2 2 2 2 2 2 2 2 2 2
Attributes:
    __version__:   0.4.0
    modality:      electrophysiology
    dtype:         SubjectEphy
    y_dtype:       none
    z_dtype:       none
    mi_type:       none
    mi_repr:       none
    sfreq:         512.0
    agg_ch:        True
    multivariate:  False
&lt;xarray.DataArray &#39;subject_3&#39; (trials: 10, roi: 5, times: 100)&gt;
array([[[0.03812157, 0.96109847, 0.68862231, ..., 0.56223005,
         0.34660205, 0.66822848],
        [0.17374589, 0.76520409, 0.09241938, ..., 0.43539829,
         0.13371479, 0.16035788],
        [0.84428554, 0.36950688, 0.88213408, ..., 0.46717451,
         0.89663649, 0.46383011],
        [0.69114326, 0.45231231, 0.1036956 , ..., 0.17067062,
         0.83677336, 0.52263092],
        [0.40904706, 0.97950454, 0.49371041, ..., 0.62478237,
         0.37522217, 0.44362652]],

       [[0.05149835, 0.56186179, 0.6657047 , ..., 0.62418784,
         0.74131297, 0.95367813],
        [0.39412857, 0.16742529, 0.45458537, ..., 0.37149487,
         0.20720978, 0.20703386],
        [0.8702827 , 0.62125481, 0.79987264, ..., 0.49515282,
         0.86119825, 0.56067652],
        [0.62348778, 0.71411526, 0.53964271, ..., 0.05385001,
         0.77161595, 0.8546659 ],
        [0.40063106, 0.41137862, 0.22944296, ..., 0.94783176,
...
         0.29369442, 0.25261376],
        [0.06810118, 0.72534338, 0.20022918, ..., 0.08962396,
         0.67320942, 0.48305145],
        [0.54040982, 0.10321585, 0.07352327, ..., 0.07764877,
         0.44524192, 0.78059097],
        [0.27097148, 0.10207005, 0.88921331, ..., 0.54807555,
         0.04222814, 0.69802347],
        [0.03239942, 0.68144083, 0.65183032, ..., 0.17891886,
         0.37168721, 0.48322902]],

       [[0.97753556, 0.63618243, 0.08444953, ..., 0.31311895,
         0.47940265, 0.30706851],
        [0.2301836 , 0.45998987, 0.04480522, ..., 0.47418094,
         0.57853034, 0.74151342],
        [0.20803344, 0.04547604, 0.66938796, ..., 0.89247498,
         0.96116887, 0.56747618],
        [0.75840313, 0.53830704, 0.49430275, ..., 0.08093783,
         0.66679821, 0.91860754],
        [0.33963873, 0.0101205 , 0.84784953, ..., 0.53146777,
         0.74399915, 0.06152408]]])
Coordinates:
  * trials   (trials) int64 0 1 2 3 4 5 6 7 8 9
  * roi      (roi) &lt;U4 &#39;ch_0&#39; &#39;ch_1&#39; &#39;ch_2&#39; &#39;ch_3&#39; &#39;ch_4&#39;
    agg_ch   (roi) int64 0 0 0 0 0
  * times    (times) float64 0.0 0.001953 0.003906 ... 0.1895 0.1914 0.1934
    subject  (trials) int64 3 3 3 3 3 3 3 3 3 3
Attributes:
    __version__:   0.4.0
    modality:      electrophysiology
    dtype:         SubjectEphy
    y_dtype:       none
    z_dtype:       none
    mi_type:       none
    mi_repr:       none
    sfreq:         512.0
    agg_ch:        True
    multivariate:  False
&lt;xarray.DataArray &#39;subject_4&#39; (trials: 10, roi: 5, times: 100)&gt;
array([[[0.74106376, 0.55935719, 0.2424272 , ..., 0.98404444,
         0.30906807, 0.63888556],
        [0.9428288 , 0.39442652, 0.23269407, ..., 0.99164979,
         0.65728757, 0.43933814],
        [0.60715069, 0.17403917, 0.46020883, ..., 0.1319645 ,
         0.80247117, 0.7217813 ],
        [0.11949065, 0.52021072, 0.44711433, ..., 0.94127724,
         0.81167741, 0.17199118],
        [0.10990135, 0.31669602, 0.82802427, ..., 0.00891928,
         0.69805746, 0.26975788]],

       [[0.13758418, 0.42387052, 0.36247875, ..., 0.92668142,
         0.94413858, 0.10650015],
        [0.57409922, 0.78585482, 0.37357235, ..., 0.08508924,
         0.76392093, 0.38298051],
        [0.25847948, 0.89990097, 0.03866074, ..., 0.02414824,
         0.30289734, 0.85341145],
        [0.47661047, 0.72353626, 0.85708929, ..., 0.05788289,
         0.72491037, 0.14672382],
        [0.8813459 , 0.60422797, 0.01915304, ..., 0.70641427,
...
         0.48337903, 0.77937543],
        [0.66641533, 0.47596571, 0.88864578, ..., 0.45400463,
         0.48327278, 0.32056553],
        [0.47073511, 0.4065013 , 0.38193843, ..., 0.74431932,
         0.67492352, 0.45467935],
        [0.27198653, 0.69529908, 0.22583192, ..., 0.07567768,
         0.05743271, 0.014888  ],
        [0.67990812, 0.13195125, 0.99179695, ..., 0.65634309,
         0.90922593, 0.21110594]],

       [[0.66609857, 0.11760948, 0.44526169, ..., 0.27071698,
         0.93674009, 0.01264613],
        [0.89199282, 0.97943807, 0.94777146, ..., 0.56577056,
         0.5334076 , 0.43852212],
        [0.77249505, 0.5719307 , 0.65369062, ..., 0.794409  ,
         0.62939354, 0.55615977],
        [0.6359517 , 0.27745937, 0.49587214, ..., 0.50440819,
         0.48336286, 0.92012505],
        [0.57100365, 0.94933234, 0.07974639, ..., 0.02405201,
         0.40241874, 0.72716086]]])
Coordinates:
  * trials   (trials) int64 0 1 2 3 4 5 6 7 8 9
  * roi      (roi) &lt;U4 &#39;ch_0&#39; &#39;ch_1&#39; &#39;ch_2&#39; &#39;ch_3&#39; &#39;ch_4&#39;
    agg_ch   (roi) int64 0 0 0 0 0
  * times    (times) float64 0.0 0.001953 0.003906 ... 0.1895 0.1914 0.1934
    subject  (trials) int64 4 4 4 4 4 4 4 4 4 4
Attributes:
    __version__:   0.4.0
    modality:      electrophysiology
    dtype:         SubjectEphy
    y_dtype:       none
    z_dtype:       none
    mi_type:       none
    mi_repr:       none
    sfreq:         512.0
    agg_ch:        True
    multivariate:  False
Time vector :  [0.         0.00195312 0.00390625 0.00585938 0.0078125  0.00976562
 0.01171875 0.01367188 0.015625   0.01757812 0.01953125 0.02148438
 0.0234375  0.02539062 0.02734375 0.02929688 0.03125    0.03320312
 0.03515625 0.03710938 0.0390625  0.04101562 0.04296875 0.04492188
 0.046875   0.04882812 0.05078125 0.05273438 0.0546875  0.05664062
 0.05859375 0.06054688 0.0625     0.06445312 0.06640625 0.06835938
 0.0703125  0.07226562 0.07421875 0.07617188 0.078125   0.08007812
 0.08203125 0.08398438 0.0859375  0.08789062 0.08984375 0.09179688
 0.09375    0.09570312 0.09765625 0.09960938 0.1015625  0.10351562
 0.10546875 0.10742188 0.109375   0.11132812 0.11328125 0.11523438
 0.1171875  0.11914062 0.12109375 0.12304688 0.125      0.12695312
 0.12890625 0.13085938 0.1328125  0.13476562 0.13671875 0.13867188
 0.140625   0.14257812 0.14453125 0.14648438 0.1484375  0.15039062
 0.15234375 0.15429688 0.15625    0.15820312 0.16015625 0.16210938
 0.1640625  0.16601562 0.16796875 0.16992188 0.171875   0.17382812
 0.17578125 0.17773438 0.1796875  0.18164062 0.18359375 0.18554688
 0.1875     0.18945312 0.19140625 0.19335938]
ROI
:        #subjects         subjects  keep
roi
ch_0          5  [0, 1, 2, 3, 4]  True
ch_1          5  [0, 1, 2, 3, 4]  True
ch_2          5  [0, 1, 2, 3, 4]  True
ch_3          5  [0, 1, 2, 3, 4]  True
ch_4          5  [0, 1, 2, 3, 4]  True
</pre></div>
</div>
</section>
<section id="multiindex-support">
<h2>MultiIndex support<a class="headerlink" href="#multiindex-support" title="Permalink to this headline">¶</a></h2>
<p>DataArray also supports multi-indexing of a single dimension.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a continuous regressor (prediction error, delta P etc.)</span>
<span class="n">dp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">n_epochs</span><span class="p">,))</span>
<span class="c1"># create a discret variable (e.g experimental conditions)</span>
<span class="n">cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>

<span class="c1"># now, create a multi-index using pandas</span>
<span class="n">midx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">((</span><span class="n">dp</span><span class="p">,</span> <span class="n">cond</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;blocks&#39;</span><span class="p">))</span>

<span class="c1"># convert again the original arrays but this time, the epoch dimension is going</span>
<span class="c1"># to be a multi-index</span>
<span class="n">x_xr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_subjects</span><span class="p">):</span>
    <span class="c1"># DataArray conversion</span>
    <span class="n">arr_xr</span> <span class="o">=</span> <span class="n">DataArray</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;epochs&#39;</span><span class="p">,</span> <span class="s1">&#39;channels&#39;</span><span class="p">,</span> <span class="s1">&#39;times&#39;</span><span class="p">),</span>
                       <span class="n">coords</span><span class="o">=</span><span class="p">(</span><span class="n">midx</span><span class="p">,</span> <span class="n">ch</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">times</span><span class="p">))</span>
    <span class="c1"># finally, replace it in the original list</span>
    <span class="n">x_xr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arr_xr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_xr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># finally, when you create your dataset you can also specify the y and z inputs</span>
<span class="c1"># by providing their names in the DataArray</span>
<a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dt</span></a> <span class="o">=</span> <a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class"><span class="n">DatasetEphy</span></a><span class="p">(</span><span class="n">x_xr</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="s1">&#39;channels&#39;</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="s1">&#39;times&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="s1">&#39;blocks&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="../../api/generated/frites.dataset.DatasetEphy.html#frites.dataset.DatasetEphy" title="frites.dataset.DatasetEphy" class="sphx-glr-backref-module-frites-dataset sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dt</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;xarray.DataArray (epochs: 10, channels: 5, times: 100)&gt;
array([[[0.24034329, 0.86171632, 0.34465303, ..., 0.54380438,
         0.63095761, 0.93720225],
        [0.61478264, 0.52128619, 0.06160772, ..., 0.20270607,
         0.00419284, 0.05594515],
        [0.91303176, 0.1706054 , 0.8651436 , ..., 0.81004235,
         0.3997639 , 0.34532053],
        [0.65921565, 0.98308403, 0.21330509, ..., 0.70466384,
         0.26965635, 0.85455873],
        [0.23678831, 0.46494301, 0.17812426, ..., 0.06969955,
         0.80267041, 0.40547512]],

       [[0.91072037, 0.99845745, 0.15396403, ..., 0.45497848,
         0.36994284, 0.83810365],
        [0.23316428, 0.94316217, 0.08442595, ..., 0.74669753,
         0.87746451, 0.391663  ],
        [0.10406672, 0.45866321, 0.7006282 , ..., 0.4829847 ,
         0.16199675, 0.83818631],
        [0.29406866, 0.00558673, 0.49541342, ..., 0.72562022,
         0.03051609, 0.8177315 ],
        [0.25638312, 0.79927744, 0.40130464, ..., 0.95306325,
...
         0.90549455, 0.03376424],
        [0.29453596, 0.52700977, 0.89888307, ..., 0.01805061,
         0.70565441, 0.54270608],
        [0.88223672, 0.52676527, 0.55937031, ..., 0.82115104,
         0.65574706, 0.74626048],
        [0.28772564, 0.39692847, 0.67759423, ..., 0.45044822,
         0.46511742, 0.60031231],
        [0.57433969, 0.43456222, 0.11748138, ..., 0.55597682,
         0.62714934, 0.61510998]],

       [[0.82983166, 0.83912682, 0.17667505, ..., 0.30211243,
         0.12577888, 0.59710437],
        [0.93456962, 0.47027299, 0.26927959, ..., 0.412699  ,
         0.86340372, 0.93950113],
        [0.90775143, 0.38248679, 0.14104779, ..., 0.0882851 ,
         0.76647458, 0.05708595],
        [0.26975885, 0.66982987, 0.25147766, ..., 0.57987697,
         0.24410713, 0.92257136],
        [0.75240244, 0.67120867, 0.76360982, ..., 0.45137771,
         0.01442582, 0.69954964]]])
Coordinates:
  * epochs    (epochs) MultiIndex
  - dp        (epochs) float64 0.3517 -0.8852 -0.5826 ... -0.4501 -0.0779
  - blocks    (epochs) int64 0 0 0 0 0 1 1 1 1 1
  * channels  (channels) &lt;U4 &#39;ch_0&#39; &#39;ch_1&#39; &#39;ch_2&#39; &#39;ch_3&#39; &#39;ch_4&#39;
  * times     (times) float64 0.0 0.001953 0.003906 ... 0.1895 0.1914 0.1934
&lt;xarray.DataArray &#39;subject_0&#39; (trials: 10, roi: 5, times: 100)&gt;
array([[[0.24034329, 0.86171632, 0.34465303, ..., 0.54380438,
         0.63095761, 0.93720225],
        [0.61478264, 0.52128619, 0.06160772, ..., 0.20270607,
         0.00419284, 0.05594515],
        [0.91303176, 0.1706054 , 0.8651436 , ..., 0.81004235,
         0.3997639 , 0.34532053],
        [0.65921565, 0.98308403, 0.21330509, ..., 0.70466384,
         0.26965635, 0.85455873],
        [0.23678831, 0.46494301, 0.17812426, ..., 0.06969955,
         0.80267041, 0.40547512]],

       [[0.91072037, 0.99845745, 0.15396403, ..., 0.45497848,
         0.36994284, 0.83810365],
        [0.23316428, 0.94316217, 0.08442595, ..., 0.74669753,
         0.87746451, 0.391663  ],
        [0.10406672, 0.45866321, 0.7006282 , ..., 0.4829847 ,
         0.16199675, 0.83818631],
        [0.29406866, 0.00558673, 0.49541342, ..., 0.72562022,
         0.03051609, 0.8177315 ],
        [0.25638312, 0.79927744, 0.40130464, ..., 0.95306325,
...
         0.90549455, 0.03376424],
        [0.29453596, 0.52700977, 0.89888307, ..., 0.01805061,
         0.70565441, 0.54270608],
        [0.88223672, 0.52676527, 0.55937031, ..., 0.82115104,
         0.65574706, 0.74626048],
        [0.28772564, 0.39692847, 0.67759423, ..., 0.45044822,
         0.46511742, 0.60031231],
        [0.57433969, 0.43456222, 0.11748138, ..., 0.55597682,
         0.62714934, 0.61510998]],

       [[0.82983166, 0.83912682, 0.17667505, ..., 0.30211243,
         0.12577888, 0.59710437],
        [0.93456962, 0.47027299, 0.26927959, ..., 0.412699  ,
         0.86340372, 0.93950113],
        [0.90775143, 0.38248679, 0.14104779, ..., 0.0882851 ,
         0.76647458, 0.05708595],
        [0.26975885, 0.66982987, 0.25147766, ..., 0.57987697,
         0.24410713, 0.92257136],
        [0.75240244, 0.67120867, 0.76360982, ..., 0.45137771,
         0.01442582, 0.69954964]]])
Coordinates:
  * trials   (trials) int64 0 1 2 3 4 5 6 7 8 9
    y        (trials) float64 0.3517 -0.8852 -0.5826 ... -0.4557 -0.4501 -0.0779
    z        (trials) int64 0 0 0 0 0 1 1 1 1 1
  * roi      (roi) &lt;U4 &#39;ch_0&#39; &#39;ch_1&#39; &#39;ch_2&#39; &#39;ch_3&#39; &#39;ch_4&#39;
    agg_ch   (roi) int64 0 0 0 0 0
  * times    (times) float64 0.0 0.001953 0.003906 ... 0.1895 0.1914 0.1934
    subject  (trials) int64 0 0 0 0 0 0 0 0 0 0
Attributes:
    __version__:   0.4.0
    modality:      electrophysiology
    dtype:         SubjectEphy
    y_dtype:       float
    z_dtype:       int
    mi_type:       ccd
    mi_repr:       I(x; y (continuous)) | z (discret)
    sfreq:         512.0
    agg_ch:        True
    multivariate:  False
&lt;xarray.DataArray &#39;subject_1&#39; (trials: 10, roi: 5, times: 100)&gt;
array([[[0.72175429, 0.75050817, 0.46214228, ..., 0.23128801,
         0.7267556 , 0.15987162],
        [0.98850847, 0.07344707, 0.52882055, ..., 0.64100186,
         0.30747571, 0.78058408],
        [0.9617843 , 0.77987935, 0.67254554, ..., 0.06091654,
         0.64701474, 0.01464767],
        [0.92468401, 0.80944684, 0.52712878, ..., 0.70166188,
         0.41720549, 0.45291127],
        [0.00520981, 0.01264942, 0.14240944, ..., 0.54996108,
         0.69567786, 0.99838839]],

       [[0.53517998, 0.12297555, 0.6055163 , ..., 0.38636983,
         0.27551176, 0.44586167],
        [0.96107471, 0.47987983, 0.81127746, ..., 0.90794777,
         0.59548204, 0.48741044],
        [0.90442449, 0.38221534, 0.67588997, ..., 0.22137111,
         0.47973779, 0.05600166],
        [0.67316509, 0.40358586, 0.51229431, ..., 0.81150807,
         0.65740563, 0.96299191],
        [0.08816517, 0.04345994, 0.01074248, ..., 0.40064736,
...
         0.94873875, 0.61944821],
        [0.91220839, 0.7291937 , 0.47878479, ..., 0.14131304,
         0.30985056, 0.62878864],
        [0.86376133, 0.46284292, 0.36097113, ..., 0.50370121,
         0.65944701, 0.20340871],
        [0.06881119, 0.87651879, 0.94823707, ..., 0.46366507,
         0.31924642, 0.92000456],
        [0.7331217 , 0.04967909, 0.79917134, ..., 0.55610828,
         0.15168246, 0.66038551]],

       [[0.97445161, 0.72366698, 0.64587503, ..., 0.513926  ,
         0.05303286, 0.94357372],
        [0.63532865, 0.1929775 , 0.5008863 , ..., 0.63650841,
         0.05092242, 0.58395556],
        [0.2794173 , 0.90774889, 0.78718551, ..., 0.50235677,
         0.26504078, 0.52206471],
        [0.49535186, 0.72798647, 0.44225394, ..., 0.55838299,
         0.11216199, 0.48820217],
        [0.99845411, 0.27739505, 0.23103634, ..., 0.39763765,
         0.33448149, 0.87292421]]])
Coordinates:
  * trials   (trials) int64 0 1 2 3 4 5 6 7 8 9
    y        (trials) float64 0.3517 -0.8852 -0.5826 ... -0.4557 -0.4501 -0.0779
    z        (trials) int64 0 0 0 0 0 1 1 1 1 1
  * roi      (roi) &lt;U4 &#39;ch_0&#39; &#39;ch_1&#39; &#39;ch_2&#39; &#39;ch_3&#39; &#39;ch_4&#39;
    agg_ch   (roi) int64 0 0 0 0 0
  * times    (times) float64 0.0 0.001953 0.003906 ... 0.1895 0.1914 0.1934
    subject  (trials) int64 1 1 1 1 1 1 1 1 1 1
Attributes:
    __version__:   0.4.0
    modality:      electrophysiology
    dtype:         SubjectEphy
    y_dtype:       float
    z_dtype:       int
    mi_type:       ccd
    mi_repr:       I(x; y (continuous)) | z (discret)
    sfreq:         512.0
    agg_ch:        True
    multivariate:  False
&lt;xarray.DataArray &#39;subject_2&#39; (trials: 10, roi: 5, times: 100)&gt;
array([[[1.19276916e-01, 9.25926167e-01, 3.67923683e-01, ...,
         9.77667193e-01, 2.86834824e-01, 4.92570237e-01],
        [7.65460747e-01, 1.62682369e-01, 6.56098667e-01, ...,
         2.91057917e-02, 7.58385354e-01, 3.90439643e-01],
        [3.59773834e-01, 1.13549616e-01, 1.28944246e-01, ...,
         9.47228805e-01, 2.76226848e-01, 3.81999824e-01],
        [5.89701332e-01, 6.30959884e-01, 1.37658164e-01, ...,
         2.97218295e-01, 7.50627378e-01, 2.92407654e-01],
        [2.84331203e-01, 1.88682815e-01, 5.72338268e-01, ...,
         2.71812864e-01, 2.15703332e-01, 9.31655783e-01]],

       [[1.82036693e-01, 9.57333041e-01, 5.17804989e-01, ...,
         6.94780424e-01, 4.90429921e-01, 5.52295408e-02],
        [1.21880929e-01, 5.86447180e-02, 8.61178933e-01, ...,
         6.95953042e-01, 9.18069001e-01, 5.83163865e-01],
        [9.27879930e-02, 5.74393310e-01, 6.83139068e-01, ...,
         3.59976102e-01, 3.18923282e-01, 8.21112466e-01],
        [5.88571550e-01, 1.02237400e-01, 6.92993238e-01, ...,
         7.29893703e-01, 9.16487603e-01, 7.58929882e-01],
        [4.64238812e-01, 4.66104724e-01, 3.49163801e-01, ...,
...
         7.22764282e-02, 9.24947099e-01, 9.94352466e-01],
        [6.19132284e-01, 1.52396512e-01, 1.39604737e-01, ...,
         5.44731664e-01, 8.65210267e-01, 8.33013793e-01],
        [3.31069424e-01, 1.23843879e-01, 3.08726593e-01, ...,
         1.54972803e-02, 4.33156531e-05, 1.09682827e-01],
        [9.53495998e-01, 4.00622578e-01, 5.49231079e-01, ...,
         2.07248956e-01, 3.04258281e-01, 3.28841265e-01],
        [9.47793597e-01, 5.23480737e-01, 3.68108879e-01, ...,
         3.28135371e-02, 5.22654365e-01, 9.95355833e-01]],

       [[4.86929633e-01, 6.72755627e-01, 3.76705987e-01, ...,
         3.78288637e-01, 4.59351282e-01, 9.84596215e-01],
        [7.76291622e-01, 5.68684135e-01, 2.69774072e-01, ...,
         7.54182740e-01, 7.58927804e-01, 3.60972499e-01],
        [3.35087956e-01, 8.90568020e-01, 4.94091783e-01, ...,
         2.43007441e-01, 2.65921644e-01, 8.65626711e-01],
        [6.57981650e-01, 4.90625838e-01, 9.75015885e-01, ...,
         1.19363862e-01, 2.93435674e-02, 3.69337115e-01],
        [2.78689259e-01, 1.59496976e-01, 4.72344087e-01, ...,
         9.84379481e-01, 6.54795053e-01, 8.44844248e-01]]])
Coordinates:
  * trials   (trials) int64 0 1 2 3 4 5 6 7 8 9
    y        (trials) float64 0.3517 -0.8852 -0.5826 ... -0.4557 -0.4501 -0.0779
    z        (trials) int64 0 0 0 0 0 1 1 1 1 1
  * roi      (roi) &lt;U4 &#39;ch_0&#39; &#39;ch_1&#39; &#39;ch_2&#39; &#39;ch_3&#39; &#39;ch_4&#39;
    agg_ch   (roi) int64 0 0 0 0 0
  * times    (times) float64 0.0 0.001953 0.003906 ... 0.1895 0.1914 0.1934
    subject  (trials) int64 2 2 2 2 2 2 2 2 2 2
Attributes:
    __version__:   0.4.0
    modality:      electrophysiology
    dtype:         SubjectEphy
    y_dtype:       float
    z_dtype:       int
    mi_type:       ccd
    mi_repr:       I(x; y (continuous)) | z (discret)
    sfreq:         512.0
    agg_ch:        True
    multivariate:  False
&lt;xarray.DataArray &#39;subject_3&#39; (trials: 10, roi: 5, times: 100)&gt;
array([[[0.03812157, 0.96109847, 0.68862231, ..., 0.56223005,
         0.34660205, 0.66822848],
        [0.17374589, 0.76520409, 0.09241938, ..., 0.43539829,
         0.13371479, 0.16035788],
        [0.84428554, 0.36950688, 0.88213408, ..., 0.46717451,
         0.89663649, 0.46383011],
        [0.69114326, 0.45231231, 0.1036956 , ..., 0.17067062,
         0.83677336, 0.52263092],
        [0.40904706, 0.97950454, 0.49371041, ..., 0.62478237,
         0.37522217, 0.44362652]],

       [[0.05149835, 0.56186179, 0.6657047 , ..., 0.62418784,
         0.74131297, 0.95367813],
        [0.39412857, 0.16742529, 0.45458537, ..., 0.37149487,
         0.20720978, 0.20703386],
        [0.8702827 , 0.62125481, 0.79987264, ..., 0.49515282,
         0.86119825, 0.56067652],
        [0.62348778, 0.71411526, 0.53964271, ..., 0.05385001,
         0.77161595, 0.8546659 ],
        [0.40063106, 0.41137862, 0.22944296, ..., 0.94783176,
...
         0.29369442, 0.25261376],
        [0.06810118, 0.72534338, 0.20022918, ..., 0.08962396,
         0.67320942, 0.48305145],
        [0.54040982, 0.10321585, 0.07352327, ..., 0.07764877,
         0.44524192, 0.78059097],
        [0.27097148, 0.10207005, 0.88921331, ..., 0.54807555,
         0.04222814, 0.69802347],
        [0.03239942, 0.68144083, 0.65183032, ..., 0.17891886,
         0.37168721, 0.48322902]],

       [[0.97753556, 0.63618243, 0.08444953, ..., 0.31311895,
         0.47940265, 0.30706851],
        [0.2301836 , 0.45998987, 0.04480522, ..., 0.47418094,
         0.57853034, 0.74151342],
        [0.20803344, 0.04547604, 0.66938796, ..., 0.89247498,
         0.96116887, 0.56747618],
        [0.75840313, 0.53830704, 0.49430275, ..., 0.08093783,
         0.66679821, 0.91860754],
        [0.33963873, 0.0101205 , 0.84784953, ..., 0.53146777,
         0.74399915, 0.06152408]]])
Coordinates:
  * trials   (trials) int64 0 1 2 3 4 5 6 7 8 9
    y        (trials) float64 0.3517 -0.8852 -0.5826 ... -0.4557 -0.4501 -0.0779
    z        (trials) int64 0 0 0 0 0 1 1 1 1 1
  * roi      (roi) &lt;U4 &#39;ch_0&#39; &#39;ch_1&#39; &#39;ch_2&#39; &#39;ch_3&#39; &#39;ch_4&#39;
    agg_ch   (roi) int64 0 0 0 0 0
  * times    (times) float64 0.0 0.001953 0.003906 ... 0.1895 0.1914 0.1934
    subject  (trials) int64 3 3 3 3 3 3 3 3 3 3
Attributes:
    __version__:   0.4.0
    modality:      electrophysiology
    dtype:         SubjectEphy
    y_dtype:       float
    z_dtype:       int
    mi_type:       ccd
    mi_repr:       I(x; y (continuous)) | z (discret)
    sfreq:         512.0
    agg_ch:        True
    multivariate:  False
&lt;xarray.DataArray &#39;subject_4&#39; (trials: 10, roi: 5, times: 100)&gt;
array([[[0.74106376, 0.55935719, 0.2424272 , ..., 0.98404444,
         0.30906807, 0.63888556],
        [0.9428288 , 0.39442652, 0.23269407, ..., 0.99164979,
         0.65728757, 0.43933814],
        [0.60715069, 0.17403917, 0.46020883, ..., 0.1319645 ,
         0.80247117, 0.7217813 ],
        [0.11949065, 0.52021072, 0.44711433, ..., 0.94127724,
         0.81167741, 0.17199118],
        [0.10990135, 0.31669602, 0.82802427, ..., 0.00891928,
         0.69805746, 0.26975788]],

       [[0.13758418, 0.42387052, 0.36247875, ..., 0.92668142,
         0.94413858, 0.10650015],
        [0.57409922, 0.78585482, 0.37357235, ..., 0.08508924,
         0.76392093, 0.38298051],
        [0.25847948, 0.89990097, 0.03866074, ..., 0.02414824,
         0.30289734, 0.85341145],
        [0.47661047, 0.72353626, 0.85708929, ..., 0.05788289,
         0.72491037, 0.14672382],
        [0.8813459 , 0.60422797, 0.01915304, ..., 0.70641427,
...
         0.48337903, 0.77937543],
        [0.66641533, 0.47596571, 0.88864578, ..., 0.45400463,
         0.48327278, 0.32056553],
        [0.47073511, 0.4065013 , 0.38193843, ..., 0.74431932,
         0.67492352, 0.45467935],
        [0.27198653, 0.69529908, 0.22583192, ..., 0.07567768,
         0.05743271, 0.014888  ],
        [0.67990812, 0.13195125, 0.99179695, ..., 0.65634309,
         0.90922593, 0.21110594]],

       [[0.66609857, 0.11760948, 0.44526169, ..., 0.27071698,
         0.93674009, 0.01264613],
        [0.89199282, 0.97943807, 0.94777146, ..., 0.56577056,
         0.5334076 , 0.43852212],
        [0.77249505, 0.5719307 , 0.65369062, ..., 0.794409  ,
         0.62939354, 0.55615977],
        [0.6359517 , 0.27745937, 0.49587214, ..., 0.50440819,
         0.48336286, 0.92012505],
        [0.57100365, 0.94933234, 0.07974639, ..., 0.02405201,
         0.40241874, 0.72716086]]])
Coordinates:
  * trials   (trials) int64 0 1 2 3 4 5 6 7 8 9
    y        (trials) float64 0.3517 -0.8852 -0.5826 ... -0.4557 -0.4501 -0.0779
    z        (trials) int64 0 0 0 0 0 1 1 1 1 1
  * roi      (roi) &lt;U4 &#39;ch_0&#39; &#39;ch_1&#39; &#39;ch_2&#39; &#39;ch_3&#39; &#39;ch_4&#39;
    agg_ch   (roi) int64 0 0 0 0 0
  * times    (times) float64 0.0 0.001953 0.003906 ... 0.1895 0.1914 0.1934
    subject  (trials) int64 4 4 4 4 4 4 4 4 4 4
Attributes:
    __version__:   0.4.0
    modality:      electrophysiology
    dtype:         SubjectEphy
    y_dtype:       float
    z_dtype:       int
    mi_type:       ccd
    mi_repr:       I(x; y (continuous)) | z (discret)
    sfreq:         512.0
    agg_ch:        True
    multivariate:  False
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  1.193 seconds)</p>
<p><strong>Estimated memory usage:</strong>  8 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-dataset-plot-dataset-xarray-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/9a005eb1fa12814043ca3f5d7ba8ead9/plot_dataset_xarray.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_dataset_xarray.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c9ee9d1b34e24156df644db7f70c9e6b/plot_dataset_xarray.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_dataset_xarray.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="plot_dataset_ephy.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Build an electrophysiological dataset</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../mi/plot_wf_mi_ccd.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">MI between two continuous variables conditioned by a discret one</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

    <hr>
    <footer>
        <div class="container">
            <img src="../../_static/baniere.png" alt="Ban" height="80">
        </div>
        <br>
        <!-- <br> -->
        <p>&copy; Copyright Last updated on 2021-10-21.</p>
    </footer>

  </body>
</html>